INFO:     Will watch for changes in these directories: ['/home/saketh/Projects/dsa']
INFO:     Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)
INFO:     Started reloader process [33962] using WatchFiles
Process SpawnProcess-1:
Traceback (most recent call last):
  File "/usr/lib/python3.10/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
  File "/usr/lib/python3.10/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
  File "/usr/lib/python3.10/asyncio/runners.py", line 44, in run
    return loop.run_until_complete(main)
  File "uvloop/loop.pyx", line 1518, in uvloop.loop.Loop.run_until_complete
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/server.py", line 70, in serve
    await self._serve(sockets)
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/server.py", line 77, in _serve
    config.load()
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/config.py", line 435, in load
    self.loaded_app = import_from_string(self.app)
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/importer.py", line 22, in import_from_string
    raise exc from None
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/importer.py", line 19, in import_from_string
    module = importlib.import_module(module_str)
  File "/usr/lib/python3.10/importlib/__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1050, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1027, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1006, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 688, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 883, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "/home/saketh/Projects/dsa/src/main.py", line 23, in <module>
    from .api import users, datasets, versioning, jobs, search, sampling, exploration, workbench, downloads
  File "/home/saketh/Projects/dsa/src/api/versioning.py", line 23, in <module>
    from src.features.refs.handlers import ListRefsHandler, CreateBranchHandler, DeleteBranchHandler
  File "/home/saketh/Projects/dsa/src/features/refs/handlers/__init__.py", line 3, in <module>
    from .list_refs import ListRefsHandler
  File "/home/saketh/Projects/dsa/src/features/refs/handlers/list_refs.py", line 6, in <module>
    from ..base_handler import BaseHandler, with_error_handling
ModuleNotFoundError: No module named 'src.features.refs.base_handler'
WARNING:  WatchFiles detected changes in 'src/features/datasets/handlers/update_dataset.py', 'src/features/sampling/handlers/get_job_data.py', 'src/features/users/handlers/login_user.py', 'src/features/search/handlers/suggest_handler.py', 'src/features/versioning/handlers/get_table_analysis.py', 'src/features/versioning/handlers/get_commit_history.py', 'src/features/search/handlers/refresh_search_index_handler.py', 'src/features/versioning/handlers/queue_import_job.py', 'src/features/users/handlers/__init__.py', 'src/features/jobs/handlers/cancel_job.py', 'src/features/sql_workbench/handlers/preview_sql.py', 'src/features/refs/handlers/delete_branch.py', 'src/features/search/handlers/__init__.py', 'src/features/refs/handlers/__init__.py', 'src/features/jobs/handlers/get_jobs.py', 'src/features/versioning/handlers/get_dataset_overview.py', 'src/features/jobs/handlers/get_job_status.py', 'src/features/datasets/handlers/grant_permission.py', 'src/features/versioning/handlers/__init__.py', 'src/features/users/handlers/create_user.py', 'src/features/versioning/handlers/get_commit_schema.py', 'src/features/versioning/handlers/checkout_commit.py', 'src/features/users/handlers/update_user.py', 'src/features/jobs/handlers/process_import_job.py', 'src/features/sampling/handlers/get_sampling_history.py', 'src/features/users/handlers/delete_user.py', 'src/features/versioning/handlers/get_data_at_ref.py', 'src/features/sql_workbench/handlers/__init__.py', 'src/features/jobs/handlers/__init__.py', 'src/features/refs/handlers/list_refs.py', 'src/features/datasets/handlers/delete_dataset.py', 'src/features/sql_workbench/handlers/transform_sql.py', 'src/features/versioning/handlers/create_commit.py', 'src/features/datasets/handlers/list_datasets.py', 'src/features/sampling/handlers/__init__.py', 'src/features/datasets/handlers/create_dataset.py', 'src/features/versioning/handlers/get_table_data.py', 'src/features/refs/handlers/create_branch.py', 'src/features/users/handlers/list_users.py', 'src/features/jobs/handlers/get_job_by_id.py', 'src/features/versioning/handlers/queue_import_job_optimized.py', 'src/features/datasets/handlers/create_dataset_with_file.py', 'src/features/search/handlers/search_datasets_handler.py', 'src/features/jobs/handlers/create_job.py', 'src/features/datasets/handlers/__init__.py'. Reloading...
/home/saketh/.local/lib/python3.10/site-packages/pydantic/_internal/_config.py:373: UserWarning: Valid config keys have changed in V2:
* 'schema_extra' has been renamed to 'json_schema_extra'
  warnings.warn(message, UserWarning)
INFO:src.api.error_handlers:Error handlers registered successfully
INFO:     Started server process [34055]
INFO:     Waiting for application startup.
INFO:src.main:Starting DSA Platform...
INFO:src.main:Database pool initialized
INFO:src.workers.job_worker:Registered executor for job type: import
INFO:src.workers.job_worker:Registered executor for job type: sampling
INFO:src.workers.job_worker:Registered executor for job type: exploration
INFO:src.workers.job_worker:Registered executor for job type: sql_transform
INFO:src.main:Job worker started
INFO:src.workers.job_worker:Starting job worker...
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'src/features/refs/handlers/__init__.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:src.main:Shutting down DSA Platform...
INFO:src.workers.job_worker:Stopping job worker...
INFO:src.main:Shutdown complete
INFO:     Application shutdown complete.
INFO:     Finished server process [34055]
/home/saketh/.local/lib/python3.10/site-packages/pydantic/_internal/_config.py:373: UserWarning: Valid config keys have changed in V2:
* 'schema_extra' has been renamed to 'json_schema_extra'
  warnings.warn(message, UserWarning)
INFO:src.api.error_handlers:Error handlers registered successfully
INFO:     Started server process [34176]
INFO:     Waiting for application startup.
INFO:src.main:Starting DSA Platform...
INFO:src.main:Database pool initialized
INFO:src.workers.job_worker:Registered executor for job type: import
INFO:src.workers.job_worker:Registered executor for job type: sampling
INFO:src.workers.job_worker:Registered executor for job type: exploration
INFO:src.workers.job_worker:Registered executor for job type: sql_transform
INFO:src.main:Job worker started
INFO:src.workers.job_worker:Starting job worker...
INFO:     Application startup complete.
[1;34mUpgrade to ydata-sdk[0m
Improve your data and profiling with ydata-sdk, featuring data quality scoring, redundancy detection, outlier identification, text validation, and synthetic data generation.
Register at https://ydata.ai/register
INFO:     127.0.0.1:49032 - "POST /api/users/register-public HTTP/1.1" 422 Unprocessable Entity
INFO:     127.0.0.1:60684 - "POST /api/users/register-public HTTP/1.1" 409 Conflict
INFO:     127.0.0.1:54340 - "POST /api/users/token HTTP/1.1" 200 OK
INFO:     127.0.0.1:49292 - "GET /api/datasets?limit=5 HTTP/1.1" 307 Temporary Redirect
INFO:     127.0.0.1:49294 - "POST /api/datasets HTTP/1.1" 307 Temporary Redirect
INFO:     127.0.0.1:60302 - "GET /api/datasets/?limit=5 HTTP/1.1" 401 Unauthorized
INFO:     127.0.0.1:60316 - "GET /api/datasets/?limit=5 HTTP/1.1" 401 Unauthorized
INFO:     127.0.0.1:60324 - "POST /api/datasets/ HTTP/1.1" 401 Unauthorized
INFO:     127.0.0.1:58748 - "POST /api/users/token HTTP/1.1" 200 OK
INFO:     127.0.0.1:58754 - "GET /api/users/me HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:55590 - "GET /api/datasets/ HTTP/1.1" 401 Unauthorized
INFO:     127.0.0.1:55606 - "GET /api/jobs/ HTTP/1.1" 307 Temporary Redirect
INFO:     127.0.0.1:55622 - "GET /api/search/datasets?q=test HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:60596 - "GET /openapi.json HTTP/1.1" 200 OK
INFO:     127.0.0.1:35080 - "POST /api/users/register-public HTTP/1.1" 200 OK
INFO:     127.0.0.1:35090 - "POST /api/users/token HTTP/1.1" 200 OK
INFO:     127.0.0.1:35972 - "GET /docs HTTP/1.1" 200 OK
INFO:     127.0.0.1:58296 - "GET /docs HTTP/1.1" 200 OK
INFO:     127.0.0.1:58296 - "GET /openapi.json HTTP/1.1" 200 OK
INFO:     127.0.0.1:58310 - "GET /docs HTTP/1.1" 200 OK
INFO:     127.0.0.1:58310 - "GET /openapi.json HTTP/1.1" 200 OK
INFO:     127.0.0.1:54260 - "GET /api/datasets/ HTTP/1.1" 401 Unauthorized
INFO:     127.0.0.1:54270 - "POST /api/datasets/ HTTP/1.1" 401 Unauthorized
INFO:     127.0.0.1:54276 - "GET /api/datasets/null HTTP/1.1" 401 Unauthorized
INFO:     127.0.0.1:60458 - "GET / HTTP/1.1" 200 OK
INFO:     127.0.0.1:60466 - "POST /api/users/token HTTP/1.1" 200 OK
INFO:     127.0.0.1:60470 - "GET /api/users/ HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:55466 - "POST /api/users/token HTTP/1.1" 200 OK
INFO:     127.0.0.1:55476 - "GET /api/datasets/ HTTP/1.1" 200 OK
INFO:     127.0.0.1:55488 - "POST /api/datasets/ HTTP/1.1" 200 OK
INFO:     127.0.0.1:42610 - "GET /api/datasets/109 HTTP/1.1" 401 Unauthorized
INFO:     127.0.0.1:42616 - "GET /api/datasets/109/refs HTTP/1.1" 401 Unauthorized
INFO:     127.0.0.1:42630 - "GET /api/jobs HTTP/1.1" 401 Unauthorized
INFO:     127.0.0.1:50518 - "POST /api/users/token HTTP/1.1" 200 OK
INFO:     127.0.0.1:50520 - "GET /api/datasets/109 HTTP/1.1" 200 OK
INFO:     127.0.0.1:50532 - "GET /api/jobs HTTP/1.1" 200 OK
INFO:     127.0.0.1:50542 - "GET /api/datasets/search/?q=test&limit=3 HTTP/1.1" 200 OK
WARNING:  WatchFiles detected changes in 'src/api/common/pagination.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:src.main:Shutting down DSA Platform...
INFO:src.workers.job_worker:Stopping job worker...
INFO:src.main:Shutdown complete
INFO:     Application shutdown complete.
INFO:     Finished server process [34176]
/home/saketh/.local/lib/python3.10/site-packages/pydantic/_internal/_config.py:373: UserWarning: Valid config keys have changed in V2:
* 'schema_extra' has been renamed to 'json_schema_extra'
  warnings.warn(message, UserWarning)
INFO:src.api.error_handlers:Error handlers registered successfully
INFO:     Started server process [35009]
INFO:     Waiting for application startup.
INFO:src.main:Starting DSA Platform...
INFO:src.main:Database pool initialized
INFO:src.workers.job_worker:Registered executor for job type: import
INFO:src.workers.job_worker:Registered executor for job type: sampling
INFO:src.workers.job_worker:Registered executor for job type: exploration
INFO:src.workers.job_worker:Registered executor for job type: sql_transform
INFO:src.main:Job worker started
INFO:src.workers.job_worker:Starting job worker...
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'src/core/services/sampling_service_refactored.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:src.main:Shutting down DSA Platform...
INFO:src.workers.job_worker:Stopping job worker...
INFO:src.main:Shutdown complete
INFO:     Application shutdown complete.
INFO:     Finished server process [35009]
/home/saketh/.local/lib/python3.10/site-packages/pydantic/_internal/_config.py:373: UserWarning: Valid config keys have changed in V2:
* 'schema_extra' has been renamed to 'json_schema_extra'
  warnings.warn(message, UserWarning)
INFO:src.api.error_handlers:Error handlers registered successfully
INFO:     Started server process [35181]
INFO:     Waiting for application startup.
INFO:src.main:Starting DSA Platform...
INFO:src.main:Database pool initialized
INFO:src.workers.job_worker:Registered executor for job type: import
INFO:src.workers.job_worker:Registered executor for job type: sampling
INFO:src.workers.job_worker:Registered executor for job type: exploration
INFO:src.workers.job_worker:Registered executor for job type: sql_transform
INFO:src.main:Job worker started
INFO:src.workers.job_worker:Starting job worker...
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'src/core/services/table_analyzer_refactored.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:src.main:Shutting down DSA Platform...
INFO:src.workers.job_worker:Stopping job worker...
INFO:src.main:Shutdown complete
INFO:     Application shutdown complete.
INFO:     Finished server process [35181]
/home/saketh/.local/lib/python3.10/site-packages/pydantic/_internal/_config.py:373: UserWarning: Valid config keys have changed in V2:
* 'schema_extra' has been renamed to 'json_schema_extra'
  warnings.warn(message, UserWarning)
INFO:src.api.error_handlers:Error handlers registered successfully
INFO:     Started server process [35277]
INFO:     Waiting for application startup.
INFO:src.main:Starting DSA Platform...
INFO:src.main:Database pool initialized
INFO:src.workers.job_worker:Registered executor for job type: import
INFO:src.workers.job_worker:Registered executor for job type: sampling
INFO:src.workers.job_worker:Registered executor for job type: exploration
INFO:src.workers.job_worker:Registered executor for job type: sql_transform
INFO:src.main:Job worker started
INFO:src.workers.job_worker:Starting job worker...
INFO:     Application startup complete.
[1;34mUpgrade to ydata-sdk[0m
Improve your data and profiling with ydata-sdk, featuring data quality scoring, redundancy detection, outlier identification, text validation, and synthetic data generation.
Register at https://ydata.ai/register
INFO:     127.0.0.1:38596 - "POST /api/users/token HTTP/1.1" 200 OK
INFO:     127.0.0.1:38612 - "GET /api/datasets/?limit=2 HTTP/1.1" 200 OK
INFO:     127.0.0.1:38614 - "GET /api/datasets/search/?q=test&limit=2 HTTP/1.1" 200 OK
INFO:     127.0.0.1:38624 - "GET /api/jobs?limit=2 HTTP/1.1" 200 OK
INFO:     127.0.0.1:50478 - "GET /docs HTTP/1.1" 200 OK
INFO:     127.0.0.1:50478 - "GET /openapi.json HTTP/1.1" 200 OK
WARNING:  WatchFiles detected changes in 'src/core/services/sampling_service.py', 'src/core/services/sampling_service_refactored.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:src.main:Shutting down DSA Platform...
INFO:src.workers.job_worker:Stopping job worker...
INFO:src.main:Shutdown complete
INFO:     Application shutdown complete.
INFO:     Finished server process [35277]
/home/saketh/.local/lib/python3.10/site-packages/pydantic/_internal/_config.py:373: UserWarning: Valid config keys have changed in V2:
* 'schema_extra' has been renamed to 'json_schema_extra'
  warnings.warn(message, UserWarning)
Process SpawnProcess-7:
Traceback (most recent call last):
  File "/usr/lib/python3.10/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
  File "/usr/lib/python3.10/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
  File "/usr/lib/python3.10/asyncio/runners.py", line 44, in run
    return loop.run_until_complete(main)
  File "uvloop/loop.pyx", line 1518, in uvloop.loop.Loop.run_until_complete
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/server.py", line 70, in serve
    await self._serve(sockets)
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/server.py", line 77, in _serve
    config.load()
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/config.py", line 435, in load
    self.loaded_app = import_from_string(self.app)
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/importer.py", line 19, in import_from_string
    module = importlib.import_module(module_str)
  File "/usr/lib/python3.10/importlib/__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1050, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1027, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1006, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 688, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 883, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "/home/saketh/Projects/dsa/src/main.py", line 23, in <module>
    from .api import users, datasets, versioning, jobs, search, sampling, exploration, workbench, downloads
  File "/home/saketh/Projects/dsa/src/api/sampling.py", line 15, in <module>
    from ..core.services.sampling_service import PostgresSamplingService, SamplingJobService
ImportError: cannot import name 'PostgresSamplingService' from 'src.core.services.sampling_service' (/home/saketh/Projects/dsa/src/core/services/sampling_service.py)
WARNING:  WatchFiles detected changes in 'src/core/services/table_analyzer.py', 'src/core/services/table_analyzer_refactored.py'. Reloading...
/home/saketh/.local/lib/python3.10/site-packages/pydantic/_internal/_config.py:373: UserWarning: Valid config keys have changed in V2:
* 'schema_extra' has been renamed to 'json_schema_extra'
  warnings.warn(message, UserWarning)
Process SpawnProcess-8:
Traceback (most recent call last):
  File "/usr/lib/python3.10/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
  File "/usr/lib/python3.10/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
  File "/usr/lib/python3.10/asyncio/runners.py", line 44, in run
    return loop.run_until_complete(main)
  File "uvloop/loop.pyx", line 1518, in uvloop.loop.Loop.run_until_complete
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/server.py", line 70, in serve
    await self._serve(sockets)
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/server.py", line 77, in _serve
    config.load()
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/config.py", line 435, in load
    self.loaded_app = import_from_string(self.app)
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/importer.py", line 19, in import_from_string
    module = importlib.import_module(module_str)
  File "/usr/lib/python3.10/importlib/__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1050, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1027, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1006, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 688, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 883, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "/home/saketh/Projects/dsa/src/main.py", line 23, in <module>
    from .api import users, datasets, versioning, jobs, search, sampling, exploration, workbench, downloads
  File "/home/saketh/Projects/dsa/src/api/sampling.py", line 15, in <module>
    from ..core.services.sampling_service import PostgresSamplingService, SamplingJobService
ImportError: cannot import name 'PostgresSamplingService' from 'src.core.services.sampling_service' (/home/saketh/Projects/dsa/src/core/services/sampling_service.py)
WARNING:  WatchFiles detected changes in 'src/api/sampling.py'. Reloading...
/home/saketh/.local/lib/python3.10/site-packages/pydantic/_internal/_config.py:373: UserWarning: Valid config keys have changed in V2:
* 'schema_extra' has been renamed to 'json_schema_extra'
  warnings.warn(message, UserWarning)
Process SpawnProcess-9:
Traceback (most recent call last):
  File "/usr/lib/python3.10/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
  File "/usr/lib/python3.10/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
  File "/usr/lib/python3.10/asyncio/runners.py", line 44, in run
    return loop.run_until_complete(main)
  File "uvloop/loop.pyx", line 1518, in uvloop.loop.Loop.run_until_complete
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/server.py", line 70, in serve
    await self._serve(sockets)
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/server.py", line 77, in _serve
    config.load()
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/config.py", line 435, in load
    self.loaded_app = import_from_string(self.app)
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/importer.py", line 19, in import_from_string
    module = importlib.import_module(module_str)
  File "/usr/lib/python3.10/importlib/__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1050, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1027, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1006, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 688, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 883, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "/home/saketh/Projects/dsa/src/main.py", line 27, in <module>
    from .workers.import_executor import ImportJobExecutor
  File "/home/saketh/Projects/dsa/src/workers/import_executor.py", line 13, in <module>
    from src.core.services.table_analyzer import TableAnalyzer
ImportError: cannot import name 'TableAnalyzer' from 'src.core.services.table_analyzer' (/home/saketh/Projects/dsa/src/core/services/table_analyzer.py)
WARNING:  WatchFiles detected changes in 'src/api/sampling.py'. Reloading...
/home/saketh/.local/lib/python3.10/site-packages/pydantic/_internal/_config.py:373: UserWarning: Valid config keys have changed in V2:
* 'schema_extra' has been renamed to 'json_schema_extra'
  warnings.warn(message, UserWarning)
Process SpawnProcess-10:
Traceback (most recent call last):
  File "/usr/lib/python3.10/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
  File "/usr/lib/python3.10/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
  File "/usr/lib/python3.10/asyncio/runners.py", line 44, in run
    return loop.run_until_complete(main)
  File "uvloop/loop.pyx", line 1518, in uvloop.loop.Loop.run_until_complete
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/server.py", line 70, in serve
    await self._serve(sockets)
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/server.py", line 77, in _serve
    config.load()
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/config.py", line 435, in load
    self.loaded_app = import_from_string(self.app)
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/importer.py", line 19, in import_from_string
    module = importlib.import_module(module_str)
  File "/usr/lib/python3.10/importlib/__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1050, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1027, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1006, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 688, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 883, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "/home/saketh/Projects/dsa/src/main.py", line 27, in <module>
    from .workers.import_executor import ImportJobExecutor
  File "/home/saketh/Projects/dsa/src/workers/import_executor.py", line 13, in <module>
    from src.core.services.table_analyzer import TableAnalyzer
ImportError: cannot import name 'TableAnalyzer' from 'src.core.services.table_analyzer' (/home/saketh/Projects/dsa/src/core/services/table_analyzer.py)
WARNING:  WatchFiles detected changes in 'src/workers/import_executor.py'. Reloading...
/home/saketh/.local/lib/python3.10/site-packages/pydantic/_internal/_config.py:373: UserWarning: Valid config keys have changed in V2:
* 'schema_extra' has been renamed to 'json_schema_extra'
  warnings.warn(message, UserWarning)
INFO:src.api.error_handlers:Error handlers registered successfully
INFO:     Started server process [36462]
INFO:     Waiting for application startup.
INFO:src.main:Starting DSA Platform...
INFO:src.main:Database pool initialized
INFO:src.workers.job_worker:Registered executor for job type: import
INFO:src.workers.job_worker:Registered executor for job type: sampling
INFO:src.workers.job_worker:Registered executor for job type: exploration
INFO:src.workers.job_worker:Registered executor for job type: sql_transform
INFO:src.main:Job worker started
INFO:src.workers.job_worker:Starting job worker...
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'src/workers/import_executor_optimized.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:src.main:Shutting down DSA Platform...
INFO:src.workers.job_worker:Stopping job worker...
INFO:src.main:Shutdown complete
INFO:     Application shutdown complete.
INFO:     Finished server process [36462]
/home/saketh/.local/lib/python3.10/site-packages/pydantic/_internal/_config.py:373: UserWarning: Valid config keys have changed in V2:
* 'schema_extra' has been renamed to 'json_schema_extra'
  warnings.warn(message, UserWarning)
INFO:src.api.error_handlers:Error handlers registered successfully
INFO:     Started server process [36554]
INFO:     Waiting for application startup.
INFO:src.main:Starting DSA Platform...
INFO:src.main:Database pool initialized
INFO:src.workers.job_worker:Registered executor for job type: import
INFO:src.workers.job_worker:Registered executor for job type: sampling
INFO:src.workers.job_worker:Registered executor for job type: exploration
INFO:src.workers.job_worker:Registered executor for job type: sql_transform
INFO:src.main:Job worker started
INFO:src.workers.job_worker:Starting job worker...
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'src/api/sampling.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:src.main:Shutting down DSA Platform...
INFO:src.workers.job_worker:Stopping job worker...
INFO:src.main:Shutdown complete
INFO:     Application shutdown complete.
INFO:     Finished server process [36554]
/home/saketh/.local/lib/python3.10/site-packages/pydantic/_internal/_config.py:373: UserWarning: Valid config keys have changed in V2:
* 'schema_extra' has been renamed to 'json_schema_extra'
  warnings.warn(message, UserWarning)
INFO:src.api.error_handlers:Error handlers registered successfully
INFO:     Started server process [36684]
INFO:     Waiting for application startup.
INFO:src.main:Starting DSA Platform...
INFO:src.main:Database pool initialized
INFO:src.workers.job_worker:Registered executor for job type: import
INFO:src.workers.job_worker:Registered executor for job type: sampling
INFO:src.workers.job_worker:Registered executor for job type: exploration
INFO:src.workers.job_worker:Registered executor for job type: sql_transform
INFO:src.main:Job worker started
INFO:src.workers.job_worker:Starting job worker...
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'src/api/sampling.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:src.main:Shutting down DSA Platform...
INFO:src.workers.job_worker:Stopping job worker...
INFO:src.main:Shutdown complete
INFO:     Application shutdown complete.
INFO:     Finished server process [36684]
/home/saketh/.local/lib/python3.10/site-packages/pydantic/_internal/_config.py:373: UserWarning: Valid config keys have changed in V2:
* 'schema_extra' has been renamed to 'json_schema_extra'
  warnings.warn(message, UserWarning)
INFO:src.api.error_handlers:Error handlers registered successfully
INFO:     Started server process [36978]
INFO:     Waiting for application startup.
INFO:src.main:Starting DSA Platform...
INFO:src.main:Database pool initialized
INFO:src.workers.job_worker:Registered executor for job type: import
INFO:src.workers.job_worker:Registered executor for job type: sampling
INFO:src.workers.job_worker:Registered executor for job type: exploration
INFO:src.workers.job_worker:Registered executor for job type: sql_transform
INFO:src.main:Job worker started
INFO:src.workers.job_worker:Starting job worker...
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'src/workers/import_executor.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:src.main:Shutting down DSA Platform...
INFO:src.workers.job_worker:Stopping job worker...
INFO:src.main:Shutdown complete
INFO:     Application shutdown complete.
INFO:     Finished server process [36978]
/home/saketh/.local/lib/python3.10/site-packages/pydantic/_internal/_config.py:373: UserWarning: Valid config keys have changed in V2:
* 'schema_extra' has been renamed to 'json_schema_extra'
  warnings.warn(message, UserWarning)
INFO:src.api.error_handlers:Error handlers registered successfully
INFO:     Started server process [37066]
INFO:     Waiting for application startup.
INFO:src.main:Starting DSA Platform...
INFO:src.main:Database pool initialized
INFO:src.workers.job_worker:Registered executor for job type: import
INFO:src.workers.job_worker:Registered executor for job type: sampling
INFO:src.workers.job_worker:Registered executor for job type: exploration
INFO:src.workers.job_worker:Registered executor for job type: sql_transform
INFO:src.main:Job worker started
INFO:src.workers.job_worker:Starting job worker...
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'src/workers/import_executor.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:src.main:Shutting down DSA Platform...
INFO:src.workers.job_worker:Stopping job worker...
INFO:src.main:Shutdown complete
INFO:     Application shutdown complete.
INFO:     Finished server process [37066]
/home/saketh/.local/lib/python3.10/site-packages/pydantic/_internal/_config.py:373: UserWarning: Valid config keys have changed in V2:
* 'schema_extra' has been renamed to 'json_schema_extra'
  warnings.warn(message, UserWarning)
INFO:src.api.error_handlers:Error handlers registered successfully
INFO:     Started server process [37271]
INFO:     Waiting for application startup.
INFO:src.main:Starting DSA Platform...
INFO:src.main:Database pool initialized
INFO:src.workers.job_worker:Registered executor for job type: import
INFO:src.workers.job_worker:Registered executor for job type: sampling
INFO:src.workers.job_worker:Registered executor for job type: exploration
INFO:src.workers.job_worker:Registered executor for job type: sql_transform
INFO:src.main:Job worker started
INFO:src.workers.job_worker:Starting job worker...
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'src/workers/import_executor_optimized.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:src.main:Shutting down DSA Platform...
INFO:src.workers.job_worker:Stopping job worker...
INFO:src.main:Shutdown complete
INFO:     Application shutdown complete.
INFO:     Finished server process [37271]
/home/saketh/.local/lib/python3.10/site-packages/pydantic/_internal/_config.py:373: UserWarning: Valid config keys have changed in V2:
* 'schema_extra' has been renamed to 'json_schema_extra'
  warnings.warn(message, UserWarning)
INFO:src.api.error_handlers:Error handlers registered successfully
INFO:     Started server process [37343]
INFO:     Waiting for application startup.
INFO:src.main:Starting DSA Platform...
INFO:src.main:Database pool initialized
INFO:src.workers.job_worker:Registered executor for job type: import
INFO:src.workers.job_worker:Registered executor for job type: sampling
INFO:src.workers.job_worker:Registered executor for job type: exploration
INFO:src.workers.job_worker:Registered executor for job type: sql_transform
INFO:src.main:Job worker started
INFO:src.workers.job_worker:Starting job worker...
INFO:     Application startup complete.
[1;34mUpgrade to ydata-sdk[0m
Improve your data and profiling with ydata-sdk, featuring data quality scoring, redundancy detection, outlier identification, text validation, and synthetic data generation.
Register at https://ydata.ai/register
INFO:     127.0.0.1:44272 - "POST /api/users/token HTTP/1.1" 200 OK
INFO:     127.0.0.1:56208 - "GET /api/sampling/datasets/109/sampling-methods HTTP/1.1" 200 OK
INFO:src.core.services.sampling_service:Starting random sampling for table primary
ERROR:src.api.error_handlers:Unexpected error handling request 8314d467-8fee-4d67-93a4-41c95bf2dc96: 'SampleConfig' object has no attribute 'stratify_column'
  + Exception Group Traceback (most recent call last):
  |   File "/home/saketh/.local/lib/python3.10/site-packages/starlette/_utils.py", line 76, in collapse_excgroups
  |     yield
  |   File "/home/saketh/.local/lib/python3.10/site-packages/starlette/middleware/base.py", line 177, in __call__
  |     async with anyio.create_task_group() as task_group:
  |   File "/home/saketh/.local/lib/python3.10/site-packages/anyio/_backends/_asyncio.py", line 772, in __aexit__
  |     raise BaseExceptionGroup(
  | exceptiongroup.ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "/home/saketh/.local/lib/python3.10/site-packages/starlette/middleware/errors.py", line 165, in __call__
    |     await self.app(scope, receive, _send)
    |   File "/home/saketh/.local/lib/python3.10/site-packages/starlette/middleware/base.py", line 176, in __call__
    |     with recv_stream, send_stream, collapse_excgroups():
    |   File "/usr/lib/python3.10/contextlib.py", line 153, in __exit__
    |     self.gen.throw(typ, value, traceback)
    |   File "/home/saketh/.local/lib/python3.10/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "/home/saketh/.local/lib/python3.10/site-packages/starlette/middleware/base.py", line 178, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |   File "/home/saketh/Projects/dsa/src/main.py", line 165, in add_request_id
    |     response = await call_next(request)
    |   File "/home/saketh/.local/lib/python3.10/site-packages/starlette/middleware/base.py", line 156, in call_next
    |     raise app_exc
    |   File "/home/saketh/.local/lib/python3.10/site-packages/starlette/middleware/base.py", line 141, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "/home/saketh/.local/lib/python3.10/site-packages/starlette/middleware/cors.py", line 85, in __call__
    |     await self.app(scope, receive, send)
    |   File "/home/saketh/.local/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
    |   File "/home/saketh/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "/home/saketh/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "/home/saketh/.local/lib/python3.10/site-packages/starlette/routing.py", line 714, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "/home/saketh/.local/lib/python3.10/site-packages/starlette/routing.py", line 734, in app
    |     await route.handle(scope, receive, send)
    |   File "/home/saketh/.local/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    |     await self.app(scope, receive, send)
    |   File "/home/saketh/.local/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
    |   File "/home/saketh/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "/home/saketh/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "/home/saketh/.local/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    |     response = await f(request)
    |   File "/home/saketh/.local/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    |     raw_response = await run_endpoint_function(
    |   File "/home/saketh/.local/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    |     return await dependant.call(**values)
    |   File "/home/saketh/Projects/dsa/src/api/sampling.py", line 277, in sample_data_direct
    |     result = await sampling_service.sample(
    |   File "/home/saketh/Projects/dsa/src/core/services/sampling_service.py", line 45, in sample
    |     sample_params = self._config_to_params(config)
    |   File "/home/saketh/Projects/dsa/src/core/services/sampling_service.py", line 189, in _config_to_params
    |     if config.stratify_column:
    | AttributeError: 'SampleConfig' object has no attribute 'stratify_column'. Did you mean: 'stratify_columns'?
    +------------------------------------

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/middleware/base.py", line 176, in __call__
    with recv_stream, send_stream, collapse_excgroups():
  File "/usr/lib/python3.10/contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/middleware/base.py", line 178, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/home/saketh/Projects/dsa/src/main.py", line 165, in add_request_id
    response = await call_next(request)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/middleware/base.py", line 156, in call_next
    raise app_exc
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/middleware/base.py", line 141, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
  File "/home/saketh/.local/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
  File "/home/saketh/.local/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
  File "/home/saketh/Projects/dsa/src/api/sampling.py", line 277, in sample_data_direct
    result = await sampling_service.sample(
  File "/home/saketh/Projects/dsa/src/core/services/sampling_service.py", line 45, in sample
    sample_params = self._config_to_params(config)
  File "/home/saketh/Projects/dsa/src/core/services/sampling_service.py", line 189, in _config_to_params
    if config.stratify_column:
AttributeError: 'SampleConfig' object has no attribute 'stratify_column'. Did you mean: 'stratify_columns'?
INFO:     127.0.0.1:50978 - "POST /api/sampling/datasets/109/sample?ref_name=main&table_key=primary HTTP/1.1" 500 Internal Server Error
ERROR:    Exception in ASGI application
  + Exception Group Traceback (most recent call last):
  |   File "/home/saketh/.local/lib/python3.10/site-packages/starlette/_utils.py", line 76, in collapse_excgroups
  |     yield
  |   File "/home/saketh/.local/lib/python3.10/site-packages/starlette/middleware/base.py", line 177, in __call__
  |     async with anyio.create_task_group() as task_group:
  |   File "/home/saketh/.local/lib/python3.10/site-packages/anyio/_backends/_asyncio.py", line 772, in __aexit__
  |     raise BaseExceptionGroup(
  | exceptiongroup.ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/protocols/http/httptools_impl.py", line 409, in run_asgi
    |     result = await app(  # type: ignore[func-returns-value]
    |   File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    |     return await self.app(scope, receive, send)
    |   File "/home/saketh/.local/lib/python3.10/site-packages/fastapi/applications.py", line 1054, in __call__
    |     await super().__call__(scope, receive, send)
    |   File "/home/saketh/.local/lib/python3.10/site-packages/starlette/applications.py", line 112, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "/home/saketh/.local/lib/python3.10/site-packages/starlette/middleware/errors.py", line 187, in __call__
    |     raise exc
    |   File "/home/saketh/.local/lib/python3.10/site-packages/starlette/middleware/errors.py", line 165, in __call__
    |     await self.app(scope, receive, _send)
    |   File "/home/saketh/.local/lib/python3.10/site-packages/starlette/middleware/base.py", line 176, in __call__
    |     with recv_stream, send_stream, collapse_excgroups():
    |   File "/usr/lib/python3.10/contextlib.py", line 153, in __exit__
    |     self.gen.throw(typ, value, traceback)
    |   File "/home/saketh/.local/lib/python3.10/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "/home/saketh/.local/lib/python3.10/site-packages/starlette/middleware/base.py", line 178, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |   File "/home/saketh/Projects/dsa/src/main.py", line 165, in add_request_id
    |     response = await call_next(request)
    |   File "/home/saketh/.local/lib/python3.10/site-packages/starlette/middleware/base.py", line 156, in call_next
    |     raise app_exc
    |   File "/home/saketh/.local/lib/python3.10/site-packages/starlette/middleware/base.py", line 141, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "/home/saketh/.local/lib/python3.10/site-packages/starlette/middleware/cors.py", line 85, in __call__
    |     await self.app(scope, receive, send)
    |   File "/home/saketh/.local/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
    |   File "/home/saketh/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "/home/saketh/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "/home/saketh/.local/lib/python3.10/site-packages/starlette/routing.py", line 714, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "/home/saketh/.local/lib/python3.10/site-packages/starlette/routing.py", line 734, in app
    |     await route.handle(scope, receive, send)
    |   File "/home/saketh/.local/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    |     await self.app(scope, receive, send)
    |   File "/home/saketh/.local/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
    |   File "/home/saketh/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "/home/saketh/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "/home/saketh/.local/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    |     response = await f(request)
    |   File "/home/saketh/.local/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    |     raw_response = await run_endpoint_function(
    |   File "/home/saketh/.local/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    |     return await dependant.call(**values)
    |   File "/home/saketh/Projects/dsa/src/api/sampling.py", line 277, in sample_data_direct
    |     result = await sampling_service.sample(
    |   File "/home/saketh/Projects/dsa/src/core/services/sampling_service.py", line 45, in sample
    |     sample_params = self._config_to_params(config)
    |   File "/home/saketh/Projects/dsa/src/core/services/sampling_service.py", line 189, in _config_to_params
    |     if config.stratify_column:
    | AttributeError: 'SampleConfig' object has no attribute 'stratify_column'. Did you mean: 'stratify_columns'?
    +------------------------------------

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/protocols/http/httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/middleware/errors.py", line 187, in __call__
    raise exc
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/middleware/base.py", line 176, in __call__
    with recv_stream, send_stream, collapse_excgroups():
  File "/usr/lib/python3.10/contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/middleware/base.py", line 178, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/home/saketh/Projects/dsa/src/main.py", line 165, in add_request_id
    response = await call_next(request)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/middleware/base.py", line 156, in call_next
    raise app_exc
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/middleware/base.py", line 141, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
  File "/home/saketh/.local/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
  File "/home/saketh/.local/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
  File "/home/saketh/Projects/dsa/src/api/sampling.py", line 277, in sample_data_direct
    result = await sampling_service.sample(
  File "/home/saketh/Projects/dsa/src/core/services/sampling_service.py", line 45, in sample
    sample_params = self._config_to_params(config)
  File "/home/saketh/Projects/dsa/src/core/services/sampling_service.py", line 189, in _config_to_params
    if config.stratify_column:
AttributeError: 'SampleConfig' object has no attribute 'stratify_column'. Did you mean: 'stratify_columns'?
WARNING:  WatchFiles detected changes in 'src/core/services/sampling_service.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:src.main:Shutting down DSA Platform...
INFO:src.workers.job_worker:Stopping job worker...
INFO:src.main:Shutdown complete
INFO:     Application shutdown complete.
INFO:     Finished server process [37343]
/home/saketh/.local/lib/python3.10/site-packages/pydantic/_internal/_config.py:373: UserWarning: Valid config keys have changed in V2:
* 'schema_extra' has been renamed to 'json_schema_extra'
  warnings.warn(message, UserWarning)
INFO:src.api.error_handlers:Error handlers registered successfully
INFO:     Started server process [37517]
INFO:     Waiting for application startup.
INFO:src.main:Starting DSA Platform...
INFO:src.main:Database pool initialized
INFO:src.workers.job_worker:Registered executor for job type: import
INFO:src.workers.job_worker:Registered executor for job type: sampling
INFO:src.workers.job_worker:Registered executor for job type: exploration
INFO:src.workers.job_worker:Registered executor for job type: sql_transform
INFO:src.main:Job worker started
INFO:src.workers.job_worker:Starting job worker...
INFO:     Application startup complete.
INFO:src.core.services.sampling_service:Starting random sampling for table primary
ERROR:src.api.error_handlers:Unexpected error handling request ba8532cd-c0bf-4de2-ab2b-016e7ec7e440: 'SampleConfig' object has no attribute 'cluster_columns'
  + Exception Group Traceback (most recent call last):
  |   File "/home/saketh/.local/lib/python3.10/site-packages/starlette/_utils.py", line 76, in collapse_excgroups
  |     yield
  |   File "/home/saketh/.local/lib/python3.10/site-packages/starlette/middleware/base.py", line 177, in __call__
  |     async with anyio.create_task_group() as task_group:
  |   File "/home/saketh/.local/lib/python3.10/site-packages/anyio/_backends/_asyncio.py", line 772, in __aexit__
  |     raise BaseExceptionGroup(
  | exceptiongroup.ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "/home/saketh/.local/lib/python3.10/site-packages/starlette/middleware/errors.py", line 165, in __call__
    |     await self.app(scope, receive, _send)
    |   File "/home/saketh/.local/lib/python3.10/site-packages/starlette/middleware/base.py", line 176, in __call__
    |     with recv_stream, send_stream, collapse_excgroups():
    |   File "/usr/lib/python3.10/contextlib.py", line 153, in __exit__
    |     self.gen.throw(typ, value, traceback)
    |   File "/home/saketh/.local/lib/python3.10/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "/home/saketh/.local/lib/python3.10/site-packages/starlette/middleware/base.py", line 178, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |   File "/home/saketh/Projects/dsa/src/main.py", line 165, in add_request_id
    |     response = await call_next(request)
    |   File "/home/saketh/.local/lib/python3.10/site-packages/starlette/middleware/base.py", line 156, in call_next
    |     raise app_exc
    |   File "/home/saketh/.local/lib/python3.10/site-packages/starlette/middleware/base.py", line 141, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "/home/saketh/.local/lib/python3.10/site-packages/starlette/middleware/cors.py", line 85, in __call__
    |     await self.app(scope, receive, send)
    |   File "/home/saketh/.local/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
    |   File "/home/saketh/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "/home/saketh/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "/home/saketh/.local/lib/python3.10/site-packages/starlette/routing.py", line 714, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "/home/saketh/.local/lib/python3.10/site-packages/starlette/routing.py", line 734, in app
    |     await route.handle(scope, receive, send)
    |   File "/home/saketh/.local/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    |     await self.app(scope, receive, send)
    |   File "/home/saketh/.local/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
    |   File "/home/saketh/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "/home/saketh/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "/home/saketh/.local/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    |     response = await f(request)
    |   File "/home/saketh/.local/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    |     raw_response = await run_endpoint_function(
    |   File "/home/saketh/.local/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    |     return await dependant.call(**values)
    |   File "/home/saketh/Projects/dsa/src/api/sampling.py", line 277, in sample_data_direct
    |     result = await sampling_service.sample(
    |   File "/home/saketh/Projects/dsa/src/core/services/sampling_service.py", line 45, in sample
    |     sample_params = self._config_to_params(config)
    |   File "/home/saketh/Projects/dsa/src/core/services/sampling_service.py", line 191, in _config_to_params
    |     if config.cluster_columns:
    | AttributeError: 'SampleConfig' object has no attribute 'cluster_columns'. Did you mean: 'cluster_column'?
    +------------------------------------

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/middleware/base.py", line 176, in __call__
    with recv_stream, send_stream, collapse_excgroups():
  File "/usr/lib/python3.10/contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/middleware/base.py", line 178, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/home/saketh/Projects/dsa/src/main.py", line 165, in add_request_id
    response = await call_next(request)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/middleware/base.py", line 156, in call_next
    raise app_exc
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/middleware/base.py", line 141, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
  File "/home/saketh/.local/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
  File "/home/saketh/.local/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
  File "/home/saketh/Projects/dsa/src/api/sampling.py", line 277, in sample_data_direct
    result = await sampling_service.sample(
  File "/home/saketh/Projects/dsa/src/core/services/sampling_service.py", line 45, in sample
    sample_params = self._config_to_params(config)
  File "/home/saketh/Projects/dsa/src/core/services/sampling_service.py", line 191, in _config_to_params
    if config.cluster_columns:
AttributeError: 'SampleConfig' object has no attribute 'cluster_columns'. Did you mean: 'cluster_column'?
[1;34mUpgrade to ydata-sdk[0m
Improve your data and profiling with ydata-sdk, featuring data quality scoring, redundancy detection, outlier identification, text validation, and synthetic data generation.
Register at https://ydata.ai/register
INFO:     127.0.0.1:53466 - "POST /api/sampling/datasets/109/sample?ref_name=main&table_key=primary HTTP/1.1" 500 Internal Server Error
ERROR:    Exception in ASGI application
  + Exception Group Traceback (most recent call last):
  |   File "/home/saketh/.local/lib/python3.10/site-packages/starlette/_utils.py", line 76, in collapse_excgroups
  |     yield
  |   File "/home/saketh/.local/lib/python3.10/site-packages/starlette/middleware/base.py", line 177, in __call__
  |     async with anyio.create_task_group() as task_group:
  |   File "/home/saketh/.local/lib/python3.10/site-packages/anyio/_backends/_asyncio.py", line 772, in __aexit__
  |     raise BaseExceptionGroup(
  | exceptiongroup.ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/protocols/http/httptools_impl.py", line 409, in run_asgi
    |     result = await app(  # type: ignore[func-returns-value]
    |   File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    |     return await self.app(scope, receive, send)
    |   File "/home/saketh/.local/lib/python3.10/site-packages/fastapi/applications.py", line 1054, in __call__
    |     await super().__call__(scope, receive, send)
    |   File "/home/saketh/.local/lib/python3.10/site-packages/starlette/applications.py", line 112, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "/home/saketh/.local/lib/python3.10/site-packages/starlette/middleware/errors.py", line 187, in __call__
    |     raise exc
    |   File "/home/saketh/.local/lib/python3.10/site-packages/starlette/middleware/errors.py", line 165, in __call__
    |     await self.app(scope, receive, _send)
    |   File "/home/saketh/.local/lib/python3.10/site-packages/starlette/middleware/base.py", line 176, in __call__
    |     with recv_stream, send_stream, collapse_excgroups():
    |   File "/usr/lib/python3.10/contextlib.py", line 153, in __exit__
    |     self.gen.throw(typ, value, traceback)
    |   File "/home/saketh/.local/lib/python3.10/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "/home/saketh/.local/lib/python3.10/site-packages/starlette/middleware/base.py", line 178, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |   File "/home/saketh/Projects/dsa/src/main.py", line 165, in add_request_id
    |     response = await call_next(request)
    |   File "/home/saketh/.local/lib/python3.10/site-packages/starlette/middleware/base.py", line 156, in call_next
    |     raise app_exc
    |   File "/home/saketh/.local/lib/python3.10/site-packages/starlette/middleware/base.py", line 141, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "/home/saketh/.local/lib/python3.10/site-packages/starlette/middleware/cors.py", line 85, in __call__
    |     await self.app(scope, receive, send)
    |   File "/home/saketh/.local/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
    |   File "/home/saketh/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "/home/saketh/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "/home/saketh/.local/lib/python3.10/site-packages/starlette/routing.py", line 714, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "/home/saketh/.local/lib/python3.10/site-packages/starlette/routing.py", line 734, in app
    |     await route.handle(scope, receive, send)
    |   File "/home/saketh/.local/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    |     await self.app(scope, receive, send)
    |   File "/home/saketh/.local/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
    |   File "/home/saketh/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "/home/saketh/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "/home/saketh/.local/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    |     response = await f(request)
    |   File "/home/saketh/.local/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    |     raw_response = await run_endpoint_function(
    |   File "/home/saketh/.local/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    |     return await dependant.call(**values)
    |   File "/home/saketh/Projects/dsa/src/api/sampling.py", line 277, in sample_data_direct
    |     result = await sampling_service.sample(
    |   File "/home/saketh/Projects/dsa/src/core/services/sampling_service.py", line 45, in sample
    |     sample_params = self._config_to_params(config)
    |   File "/home/saketh/Projects/dsa/src/core/services/sampling_service.py", line 191, in _config_to_params
    |     if config.cluster_columns:
    | AttributeError: 'SampleConfig' object has no attribute 'cluster_columns'. Did you mean: 'cluster_column'?
    +------------------------------------

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/protocols/http/httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/middleware/errors.py", line 187, in __call__
    raise exc
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/middleware/base.py", line 176, in __call__
    with recv_stream, send_stream, collapse_excgroups():
  File "/usr/lib/python3.10/contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/_utils.py", line 82, in collapse_excgroups
    raise exc
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/middleware/base.py", line 178, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/home/saketh/Projects/dsa/src/main.py", line 165, in add_request_id
    response = await call_next(request)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/middleware/base.py", line 156, in call_next
    raise app_exc
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/middleware/base.py", line 141, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
  File "/home/saketh/.local/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
  File "/home/saketh/.local/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
  File "/home/saketh/Projects/dsa/src/api/sampling.py", line 277, in sample_data_direct
    result = await sampling_service.sample(
  File "/home/saketh/Projects/dsa/src/core/services/sampling_service.py", line 45, in sample
    sample_params = self._config_to_params(config)
  File "/home/saketh/Projects/dsa/src/core/services/sampling_service.py", line 191, in _config_to_params
    if config.cluster_columns:
AttributeError: 'SampleConfig' object has no attribute 'cluster_columns'. Did you mean: 'cluster_column'?
WARNING:  WatchFiles detected changes in 'src/core/services/sampling_service.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:src.main:Shutting down DSA Platform...
INFO:src.workers.job_worker:Stopping job worker...
INFO:src.main:Shutdown complete
INFO:     Application shutdown complete.
INFO:     Finished server process [37517]
/home/saketh/.local/lib/python3.10/site-packages/pydantic/_internal/_config.py:373: UserWarning: Valid config keys have changed in V2:
* 'schema_extra' has been renamed to 'json_schema_extra'
  warnings.warn(message, UserWarning)
INFO:src.api.error_handlers:Error handlers registered successfully
INFO:     Started server process [37680]
INFO:     Waiting for application startup.
INFO:src.main:Starting DSA Platform...
INFO:src.main:Database pool initialized
INFO:src.workers.job_worker:Registered executor for job type: import
INFO:src.workers.job_worker:Registered executor for job type: sampling
INFO:src.workers.job_worker:Registered executor for job type: exploration
INFO:src.workers.job_worker:Registered executor for job type: sql_transform
INFO:src.main:Job worker started
INFO:src.workers.job_worker:Starting job worker...
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'src/core/services/sampling_service.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:src.main:Shutting down DSA Platform...
INFO:src.workers.job_worker:Stopping job worker...
INFO:src.main:Shutdown complete
INFO:     Application shutdown complete.
INFO:     Finished server process [37680]
/home/saketh/.local/lib/python3.10/site-packages/pydantic/_internal/_config.py:373: UserWarning: Valid config keys have changed in V2:
* 'schema_extra' has been renamed to 'json_schema_extra'
  warnings.warn(message, UserWarning)
INFO:src.api.error_handlers:Error handlers registered successfully
INFO:     Started server process [37840]
INFO:     Waiting for application startup.
INFO:src.main:Starting DSA Platform...
INFO:src.main:Database pool initialized
INFO:src.workers.job_worker:Registered executor for job type: import
INFO:src.workers.job_worker:Registered executor for job type: sampling
INFO:src.workers.job_worker:Registered executor for job type: exploration
INFO:src.workers.job_worker:Registered executor for job type: sql_transform
INFO:src.main:Job worker started
INFO:src.workers.job_worker:Starting job worker...
INFO:     Application startup complete.
INFO:src.core.services.sampling_service:Starting random sampling for table primary
INFO:src.core.services.sampling_service:Sampled 0 rows using random
[1;34mUpgrade to ydata-sdk[0m
Improve your data and profiling with ydata-sdk, featuring data quality scoring, redundancy detection, outlier identification, text validation, and synthetic data generation.
Register at https://ydata.ai/register
INFO:     127.0.0.1:35436 - "POST /api/sampling/datasets/109/sample?ref_name=main&table_key=primary HTTP/1.1" 200 OK
INFO:src.core.services.sampling_service:Created sampling job c069179a-36b0-4ef4-9906-4d9841a2c804 for dataset 109
INFO:     127.0.0.1:49710 - "POST /api/sampling/datasets/109/jobs HTTP/1.1" 200 OK
INFO:src.workers.job_worker:Processing job c069179a-36b0-4ef4-9906-4d9841a2c804 of type sampling
INFO:src.workers.job_worker:Job parameters type: <class 'dict'>, value: {'rounds': [{'method': 'random', 'parameters': {'sample_size': 100}, 'output_name': 'random_sample'}], 'user_id': 87, 'table_key': 'primary', 'dataset_id': 109, 'commit_message': 'Test sampling', 'export_residual': False, 'source_commit_id': None, 'create_output_commit': True, 'residual_output_name': None}
INFO:src.workers.sampling_executor:Starting sampling job c069179a-36b0-4ef4-9906-4d9841a2c804 with parameters: {'rounds': [{'method': 'random', 'parameters': {'sample_size': 100}, 'output_name': 'random_sample'}], 'user_id': 87, 'table_key': 'primary', 'dataset_id': 109, 'commit_message': 'Test sampling', 'export_residual': False, 'source_commit_id': None, 'create_output_commit': True, 'residual_output_name': None}
INFO:src.workers.sampling_executor:Executing sampling round 1
ERROR:src.workers.job_worker:Job c069179a-36b0-4ef4-9906-4d9841a2c804 failed: 'NoneType' object has no attribute 'strip'
Traceback (most recent call last):
  File "/home/saketh/Projects/dsa/src/workers/job_worker.py", line 72, in process_job
    result = await executor.execute(job_id, parameters, self.db_pool)
  File "/home/saketh/Projects/dsa/src/workers/sampling_executor.py", line 425, in execute
    parameters['source_commit_id'].strip(),  # Remove any trailing spaces
AttributeError: 'NoneType' object has no attribute 'strip'

INFO:     127.0.0.1:40350 - "GET /api/sampling/datasets/109/history?limit=5 HTTP/1.1" 200 OK
INFO:     127.0.0.1:56032 - "POST /api/users/token HTTP/1.1" 200 OK
INFO:     127.0.0.1:56032 - "OPTIONS /api/datasets/search/?fuzzy=true&limit=12&sort_by=relevance&sort_order=desc&include_facets=true HTTP/1.1" 200 OK
INFO:     127.0.0.1:56032 - "GET /api/datasets/search/?fuzzy=true&limit=12&sort_by=relevance&sort_order=desc&include_facets=true HTTP/1.1" 200 OK
INFO:     127.0.0.1:43408 - "OPTIONS /api/datasets/91/overview HTTP/1.1" 200 OK
INFO:     127.0.0.1:43408 - "OPTIONS /api/datasets/91/ready HTTP/1.1" 200 OK
INFO:     127.0.0.1:43408 - "GET /api/datasets/91/ready HTTP/1.1" 200 OK
INFO:     127.0.0.1:43408 - "GET /api/datasets/91/ready HTTP/1.1" 200 OK
INFO:     127.0.0.1:43408 - "GET /api/datasets/91/ready HTTP/1.1" 200 OK
INFO:     127.0.0.1:43418 - "GET /api/datasets/91/overview HTTP/1.1" 200 OK
INFO:     127.0.0.1:43422 - "OPTIONS /api/datasets/91/refs/main/tables/Electric_Vehicle_Population_Data/analysis HTTP/1.1" 200 OK
INFO:     127.0.0.1:43432 - "OPTIONS /api/datasets/91/refs/main/tables/Electric_Vehicle_Population_Data/preview HTTP/1.1" 200 OK
INFO:     127.0.0.1:43432 - "GET /api/datasets/91/refs/main/tables/Electric_Vehicle_Population_Data/preview HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:43418 - "OPTIONS /api/exploration/datasets/91/history?limit=50 HTTP/1.1" 200 OK
INFO:     127.0.0.1:43418 - "GET /api/exploration/datasets/91/history?limit=50 HTTP/1.1" 200 OK
WARNING:src.features.base_handler:Validation error in GetTableAnalysisHandler: 6 validation errors for TableAnalysisResponse
sheet_name
  Field required [type=missing, input_value={'table_key': 'Electric_V...']}, 'statistics': None}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
column_stats
  Field required [type=missing, input_value={'table_key': 'Electric_V...']}, 'statistics': None}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
sample_data
  Field required [type=missing, input_value={'table_key': 'Electric_V...']}, 'statistics': None}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
row_count
  Field required [type=missing, input_value={'table_key': 'Electric_V...']}, 'statistics': None}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
unique_counts
  Field required [type=missing, input_value={'table_key': 'Electric_V...']}, 'statistics': None}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
data_types
  Field required [type=missing, input_value={'table_key': 'Electric_V...']}, 'statistics': None}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
INFO:     127.0.0.1:43422 - "GET /api/datasets/91/refs/main/tables/Electric_Vehicle_Population_Data/analysis HTTP/1.1" 400 Bad Request
INFO:     127.0.0.1:43422 - "GET /api/datasets/91/refs/main/tables/Electric_Vehicle_Population_Data/preview HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:43418 - "GET /api/datasets/search/?fuzzy=true&limit=12&sort_by=relevance&sort_order=desc&include_facets=true HTTP/1.1" 200 OK
WARNING:src.features.base_handler:Validation error in GetTableAnalysisHandler: 6 validation errors for TableAnalysisResponse
sheet_name
  Field required [type=missing, input_value={'table_key': 'Electric_V...']}, 'statistics': None}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
column_stats
  Field required [type=missing, input_value={'table_key': 'Electric_V...']}, 'statistics': None}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
sample_data
  Field required [type=missing, input_value={'table_key': 'Electric_V...']}, 'statistics': None}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
row_count
  Field required [type=missing, input_value={'table_key': 'Electric_V...']}, 'statistics': None}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
unique_counts
  Field required [type=missing, input_value={'table_key': 'Electric_V...']}, 'statistics': None}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
data_types
  Field required [type=missing, input_value={'table_key': 'Electric_V...']}, 'statistics': None}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
INFO:     127.0.0.1:43422 - "GET /api/datasets/91/refs/main/tables/Electric_Vehicle_Population_Data/analysis HTTP/1.1" 400 Bad Request
INFO:     127.0.0.1:48672 - "OPTIONS /api/datasets/105/overview HTTP/1.1" 200 OK
INFO:     127.0.0.1:48672 - "GET /api/datasets/105/overview HTTP/1.1" 200 OK
INFO:     127.0.0.1:48672 - "OPTIONS /api/datasets/104/overview HTTP/1.1" 200 OK
INFO:     127.0.0.1:48672 - "GET /api/datasets/104/overview HTTP/1.1" 200 OK
INFO:     127.0.0.1:53066 - "GET /api/datasets/91/refs/main/tables/Electric_Vehicle_Population_Data/preview HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:53070 - "GET /api/datasets/91/ready HTTP/1.1" 200 OK
INFO:     127.0.0.1:53070 - "GET /api/datasets/91/ready HTTP/1.1" 200 OK
INFO:     127.0.0.1:53070 - "GET /api/datasets/91/ready HTTP/1.1" 200 OK
INFO:     127.0.0.1:53070 - "GET /api/datasets/91/ready HTTP/1.1" 200 OK
INFO:     127.0.0.1:53072 - "OPTIONS /api/sampling/datasets/91/history?limit=10&offset=0 HTTP/1.1" 200 OK
INFO:     127.0.0.1:53070 - "GET /api/datasets/91/ready HTTP/1.1" 200 OK
INFO:     127.0.0.1:53070 - "GET /api/sampling/datasets/91/history?limit=10&offset=0 HTTP/1.1" 200 OK
INFO:     127.0.0.1:53070 - "GET /api/datasets/91/ready HTTP/1.1" 200 OK
WARNING:src.features.base_handler:Validation error in GetTableAnalysisHandler: 6 validation errors for TableAnalysisResponse
sheet_name
  Field required [type=missing, input_value={'table_key': 'Electric_V...']}, 'statistics': None}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
column_stats
  Field required [type=missing, input_value={'table_key': 'Electric_V...']}, 'statistics': None}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
sample_data
  Field required [type=missing, input_value={'table_key': 'Electric_V...']}, 'statistics': None}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
row_count
  Field required [type=missing, input_value={'table_key': 'Electric_V...']}, 'statistics': None}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
unique_counts
  Field required [type=missing, input_value={'table_key': 'Electric_V...']}, 'statistics': None}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
data_types
  Field required [type=missing, input_value={'table_key': 'Electric_V...']}, 'statistics': None}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
INFO:     127.0.0.1:48672 - "GET /api/datasets/91/refs/main/tables/Electric_Vehicle_Population_Data/analysis HTTP/1.1" 400 Bad Request
WARNING:src.features.base_handler:Validation error in GetTableAnalysisHandler: 6 validation errors for TableAnalysisResponse
sheet_name
  Field required [type=missing, input_value={'table_key': 'Electric_V...']}, 'statistics': None}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
column_stats
  Field required [type=missing, input_value={'table_key': 'Electric_V...']}, 'statistics': None}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
sample_data
  Field required [type=missing, input_value={'table_key': 'Electric_V...']}, 'statistics': None}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
row_count
  Field required [type=missing, input_value={'table_key': 'Electric_V...']}, 'statistics': None}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
unique_counts
  Field required [type=missing, input_value={'table_key': 'Electric_V...']}, 'statistics': None}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
data_types
  Field required [type=missing, input_value={'table_key': 'Electric_V...']}, 'statistics': None}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
INFO:     127.0.0.1:53066 - "GET /api/datasets/91/refs/main/tables/Electric_Vehicle_Population_Data/analysis HTTP/1.1" 400 Bad Request
INFO:     127.0.0.1:58884 - "OPTIONS /api/datasets/109/overview HTTP/1.1" 200 OK
INFO:     127.0.0.1:58884 - "GET /api/datasets/109/overview HTTP/1.1" 200 OK
WARNING:  WatchFiles detected changes in 'src/api/datasets.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:src.main:Shutting down DSA Platform...
INFO:src.workers.job_worker:Stopping job worker...
INFO:src.main:Shutdown complete
INFO:     Application shutdown complete.
INFO:     Finished server process [37840]
/home/saketh/.local/lib/python3.10/site-packages/pydantic/_internal/_config.py:373: UserWarning: Valid config keys have changed in V2:
* 'schema_extra' has been renamed to 'json_schema_extra'
  warnings.warn(message, UserWarning)
INFO:src.api.error_handlers:Error handlers registered successfully
INFO:     Started server process [39870]
INFO:     Waiting for application startup.
INFO:src.main:Starting DSA Platform...
INFO:src.main:Database pool initialized
INFO:src.workers.job_worker:Registered executor for job type: import
INFO:src.workers.job_worker:Registered executor for job type: sampling
INFO:src.workers.job_worker:Registered executor for job type: exploration
INFO:src.workers.job_worker:Registered executor for job type: sql_transform
INFO:src.main:Job worker started
INFO:src.workers.job_worker:Starting job worker...
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'src/api/datasets.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:src.main:Shutting down DSA Platform...
INFO:src.workers.job_worker:Stopping job worker...
INFO:src.main:Shutdown complete
INFO:     Application shutdown complete.
INFO:     Finished server process [39870]
/home/saketh/.local/lib/python3.10/site-packages/pydantic/_internal/_config.py:373: UserWarning: Valid config keys have changed in V2:
* 'schema_extra' has been renamed to 'json_schema_extra'
  warnings.warn(message, UserWarning)
INFO:src.api.error_handlers:Error handlers registered successfully
INFO:     Started server process [39998]
INFO:     Waiting for application startup.
INFO:src.main:Starting DSA Platform...
INFO:src.main:Database pool initialized
INFO:src.workers.job_worker:Registered executor for job type: import
INFO:src.workers.job_worker:Registered executor for job type: sampling
INFO:src.workers.job_worker:Registered executor for job type: exploration
INFO:src.workers.job_worker:Registered executor for job type: sql_transform
INFO:src.main:Job worker started
INFO:src.workers.job_worker:Starting job worker...
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'src/api/datasets.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:src.main:Shutting down DSA Platform...
INFO:src.workers.job_worker:Stopping job worker...
INFO:src.main:Shutdown complete
INFO:     Application shutdown complete.
INFO:     Finished server process [39998]
/home/saketh/.local/lib/python3.10/site-packages/pydantic/_internal/_config.py:373: UserWarning: Valid config keys have changed in V2:
* 'schema_extra' has been renamed to 'json_schema_extra'
  warnings.warn(message, UserWarning)
INFO:src.api.error_handlers:Error handlers registered successfully
INFO:     Started server process [40085]
INFO:     Waiting for application startup.
INFO:src.main:Starting DSA Platform...
INFO:src.main:Database pool initialized
INFO:src.workers.job_worker:Registered executor for job type: import
INFO:src.workers.job_worker:Registered executor for job type: sampling
INFO:src.workers.job_worker:Registered executor for job type: exploration
INFO:src.workers.job_worker:Registered executor for job type: sql_transform
INFO:src.main:Job worker started
INFO:src.workers.job_worker:Starting job worker...
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'src/api/datasets.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:src.main:Shutting down DSA Platform...
INFO:src.workers.job_worker:Stopping job worker...
INFO:src.main:Shutdown complete
INFO:     Application shutdown complete.
INFO:     Finished server process [40085]
/home/saketh/.local/lib/python3.10/site-packages/pydantic/_internal/_config.py:373: UserWarning: Valid config keys have changed in V2:
* 'schema_extra' has been renamed to 'json_schema_extra'
  warnings.warn(message, UserWarning)
INFO:src.api.error_handlers:Error handlers registered successfully
INFO:     Started server process [40181]
INFO:     Waiting for application startup.
INFO:src.main:Starting DSA Platform...
INFO:src.main:Database pool initialized
INFO:src.workers.job_worker:Registered executor for job type: import
INFO:src.workers.job_worker:Registered executor for job type: sampling
INFO:src.workers.job_worker:Registered executor for job type: exploration
INFO:src.workers.job_worker:Registered executor for job type: sql_transform
INFO:src.main:Job worker started
INFO:src.workers.job_worker:Starting job worker...
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'src/features/datasets/handlers/get_dataset.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:src.main:Shutting down DSA Platform...
INFO:src.workers.job_worker:Stopping job worker...
INFO:src.main:Shutdown complete
INFO:     Application shutdown complete.
INFO:     Finished server process [40181]
/home/saketh/.local/lib/python3.10/site-packages/pydantic/_internal/_config.py:373: UserWarning: Valid config keys have changed in V2:
* 'schema_extra' has been renamed to 'json_schema_extra'
  warnings.warn(message, UserWarning)
INFO:src.api.error_handlers:Error handlers registered successfully
INFO:     Started server process [40281]
INFO:     Waiting for application startup.
INFO:src.main:Starting DSA Platform...
INFO:src.main:Database pool initialized
INFO:src.workers.job_worker:Registered executor for job type: import
INFO:src.workers.job_worker:Registered executor for job type: sampling
INFO:src.workers.job_worker:Registered executor for job type: exploration
INFO:src.workers.job_worker:Registered executor for job type: sql_transform
INFO:src.main:Job worker started
INFO:src.workers.job_worker:Starting job worker...
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'src/api/datasets.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:src.main:Shutting down DSA Platform...
INFO:src.workers.job_worker:Stopping job worker...
INFO:src.main:Shutdown complete
INFO:     Application shutdown complete.
INFO:     Finished server process [40281]
/home/saketh/.local/lib/python3.10/site-packages/pydantic/_internal/_config.py:373: UserWarning: Valid config keys have changed in V2:
* 'schema_extra' has been renamed to 'json_schema_extra'
  warnings.warn(message, UserWarning)
INFO:src.api.error_handlers:Error handlers registered successfully
INFO:     Started server process [40376]
INFO:     Waiting for application startup.
INFO:src.main:Starting DSA Platform...
INFO:src.main:Database pool initialized
INFO:src.workers.job_worker:Registered executor for job type: import
INFO:src.workers.job_worker:Registered executor for job type: sampling
INFO:src.workers.job_worker:Registered executor for job type: exploration
INFO:src.workers.job_worker:Registered executor for job type: sql_transform
INFO:src.main:Job worker started
INFO:src.workers.job_worker:Starting job worker...
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'src/api/datasets.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:src.main:Shutting down DSA Platform...
INFO:src.workers.job_worker:Stopping job worker...
INFO:src.main:Shutdown complete
INFO:     Application shutdown complete.
INFO:     Finished server process [40376]
/home/saketh/.local/lib/python3.10/site-packages/pydantic/_internal/_config.py:373: UserWarning: Valid config keys have changed in V2:
* 'schema_extra' has been renamed to 'json_schema_extra'
  warnings.warn(message, UserWarning)
INFO:src.api.error_handlers:Error handlers registered successfully
INFO:     Started server process [40475]
INFO:     Waiting for application startup.
INFO:src.main:Starting DSA Platform...
INFO:src.main:Database pool initialized
INFO:src.workers.job_worker:Registered executor for job type: import
INFO:src.workers.job_worker:Registered executor for job type: sampling
INFO:src.workers.job_worker:Registered executor for job type: exploration
INFO:src.workers.job_worker:Registered executor for job type: sql_transform
INFO:src.main:Job worker started
INFO:src.workers.job_worker:Starting job worker...
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'src/features/datasets/handlers/check_dataset_ready.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:src.main:Shutting down DSA Platform...
INFO:src.workers.job_worker:Stopping job worker...
INFO:src.main:Shutdown complete
INFO:     Application shutdown complete.
INFO:     Finished server process [40475]
/home/saketh/.local/lib/python3.10/site-packages/pydantic/_internal/_config.py:373: UserWarning: Valid config keys have changed in V2:
* 'schema_extra' has been renamed to 'json_schema_extra'
  warnings.warn(message, UserWarning)
INFO:src.api.error_handlers:Error handlers registered successfully
INFO:     Started server process [40570]
INFO:     Waiting for application startup.
INFO:src.main:Starting DSA Platform...
INFO:src.main:Database pool initialized
INFO:src.workers.job_worker:Registered executor for job type: import
INFO:src.workers.job_worker:Registered executor for job type: sampling
INFO:src.workers.job_worker:Registered executor for job type: exploration
INFO:src.workers.job_worker:Registered executor for job type: sql_transform
INFO:src.main:Job worker started
INFO:src.workers.job_worker:Starting job worker...
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'src/api/datasets.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:src.main:Shutting down DSA Platform...
INFO:src.workers.job_worker:Stopping job worker...
INFO:src.main:Shutdown complete
INFO:     Application shutdown complete.
INFO:     Finished server process [40570]
/home/saketh/.local/lib/python3.10/site-packages/pydantic/_internal/_config.py:373: UserWarning: Valid config keys have changed in V2:
* 'schema_extra' has been renamed to 'json_schema_extra'
  warnings.warn(message, UserWarning)
INFO:src.api.error_handlers:Error handlers registered successfully
INFO:     Started server process [40658]
INFO:     Waiting for application startup.
INFO:src.main:Starting DSA Platform...
INFO:src.main:Database pool initialized
INFO:src.workers.job_worker:Registered executor for job type: import
INFO:src.workers.job_worker:Registered executor for job type: sampling
INFO:src.workers.job_worker:Registered executor for job type: exploration
INFO:src.workers.job_worker:Registered executor for job type: sql_transform
INFO:src.main:Job worker started
INFO:src.workers.job_worker:Starting job worker...
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'src/features/sampling/handlers/create_sampling_job.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:src.main:Shutting down DSA Platform...
INFO:src.workers.job_worker:Stopping job worker...
INFO:src.main:Shutdown complete
INFO:     Application shutdown complete.
INFO:     Finished server process [40658]
/home/saketh/.local/lib/python3.10/site-packages/pydantic/_internal/_config.py:373: UserWarning: Valid config keys have changed in V2:
* 'schema_extra' has been renamed to 'json_schema_extra'
  warnings.warn(message, UserWarning)
INFO:src.api.error_handlers:Error handlers registered successfully
INFO:     Started server process [40738]
INFO:     Waiting for application startup.
INFO:src.main:Starting DSA Platform...
INFO:src.main:Database pool initialized
INFO:src.workers.job_worker:Registered executor for job type: import
INFO:src.workers.job_worker:Registered executor for job type: sampling
INFO:src.workers.job_worker:Registered executor for job type: exploration
INFO:src.workers.job_worker:Registered executor for job type: sql_transform
INFO:src.main:Job worker started
INFO:src.workers.job_worker:Starting job worker...
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'src/features/sampling/handlers/sample_data_direct.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:src.main:Shutting down DSA Platform...
INFO:src.workers.job_worker:Stopping job worker...
INFO:src.main:Shutdown complete
INFO:     Application shutdown complete.
INFO:     Finished server process [40738]
/home/saketh/.local/lib/python3.10/site-packages/pydantic/_internal/_config.py:373: UserWarning: Valid config keys have changed in V2:
* 'schema_extra' has been renamed to 'json_schema_extra'
  warnings.warn(message, UserWarning)
INFO:src.api.error_handlers:Error handlers registered successfully
INFO:     Started server process [40809]
INFO:     Waiting for application startup.
INFO:src.main:Starting DSA Platform...
INFO:src.main:Database pool initialized
INFO:src.workers.job_worker:Registered executor for job type: import
INFO:src.workers.job_worker:Registered executor for job type: sampling
INFO:src.workers.job_worker:Registered executor for job type: exploration
INFO:src.workers.job_worker:Registered executor for job type: sql_transform
INFO:src.main:Job worker started
INFO:src.workers.job_worker:Starting job worker...
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'src/features/sampling/handlers/get_column_samples.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:src.main:Shutting down DSA Platform...
INFO:src.workers.job_worker:Stopping job worker...
INFO:src.main:Shutdown complete
INFO:     Application shutdown complete.
INFO:     Finished server process [40809]
/home/saketh/.local/lib/python3.10/site-packages/pydantic/_internal/_config.py:373: UserWarning: Valid config keys have changed in V2:
* 'schema_extra' has been renamed to 'json_schema_extra'
  warnings.warn(message, UserWarning)
INFO:src.api.error_handlers:Error handlers registered successfully
INFO:     Started server process [40940]
INFO:     Waiting for application startup.
INFO:src.main:Starting DSA Platform...
INFO:src.main:Database pool initialized
INFO:src.workers.job_worker:Registered executor for job type: import
INFO:src.workers.job_worker:Registered executor for job type: sampling
INFO:src.workers.job_worker:Registered executor for job type: exploration
INFO:src.workers.job_worker:Registered executor for job type: sql_transform
INFO:src.main:Job worker started
INFO:src.workers.job_worker:Starting job worker...
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'src/features/sampling/handlers/get_sampling_methods.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:src.main:Shutting down DSA Platform...
INFO:src.workers.job_worker:Stopping job worker...
INFO:src.main:Shutdown complete
INFO:     Application shutdown complete.
INFO:     Finished server process [40940]
/home/saketh/.local/lib/python3.10/site-packages/pydantic/_internal/_config.py:373: UserWarning: Valid config keys have changed in V2:
* 'schema_extra' has been renamed to 'json_schema_extra'
  warnings.warn(message, UserWarning)
INFO:src.api.error_handlers:Error handlers registered successfully
INFO:     Started server process [41029]
INFO:     Waiting for application startup.
INFO:src.main:Starting DSA Platform...
INFO:src.main:Database pool initialized
INFO:src.workers.job_worker:Registered executor for job type: import
INFO:src.workers.job_worker:Registered executor for job type: sampling
INFO:src.workers.job_worker:Registered executor for job type: exploration
INFO:src.workers.job_worker:Registered executor for job type: sql_transform
INFO:src.main:Job worker started
INFO:src.workers.job_worker:Starting job worker...
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'src/api/sampling.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:src.main:Shutting down DSA Platform...
INFO:src.workers.job_worker:Stopping job worker...
INFO:src.main:Shutdown complete
INFO:     Application shutdown complete.
INFO:     Finished server process [41029]
/home/saketh/.local/lib/python3.10/site-packages/pydantic/_internal/_config.py:373: UserWarning: Valid config keys have changed in V2:
* 'schema_extra' has been renamed to 'json_schema_extra'
  warnings.warn(message, UserWarning)
Process SpawnProcess-34:
Traceback (most recent call last):
  File "/usr/lib/python3.10/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
  File "/usr/lib/python3.10/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
  File "/usr/lib/python3.10/asyncio/runners.py", line 44, in run
    return loop.run_until_complete(main)
  File "uvloop/loop.pyx", line 1518, in uvloop.loop.Loop.run_until_complete
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/server.py", line 70, in serve
    await self._serve(sockets)
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/server.py", line 77, in _serve
    config.load()
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/config.py", line 435, in load
    self.loaded_app = import_from_string(self.app)
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/importer.py", line 19, in import_from_string
    module = importlib.import_module(module_str)
  File "/usr/lib/python3.10/importlib/__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1050, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1027, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1006, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 688, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 883, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "/home/saketh/Projects/dsa/src/main.py", line 23, in <module>
    from .api import users, datasets, versioning, jobs, search, sampling, exploration, workbench, downloads
  File "/home/saketh/Projects/dsa/src/api/sampling.py", line 253
    """Perform direct sampling and return results immediately.\""""
       ^^^^^^^
SyntaxError: invalid syntax
WARNING:  WatchFiles detected changes in 'src/api/sampling.py'. Reloading...
/home/saketh/.local/lib/python3.10/site-packages/pydantic/_internal/_config.py:373: UserWarning: Valid config keys have changed in V2:
* 'schema_extra' has been renamed to 'json_schema_extra'
  warnings.warn(message, UserWarning)
Process SpawnProcess-35:
Traceback (most recent call last):
  File "/usr/lib/python3.10/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
  File "/usr/lib/python3.10/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
  File "/usr/lib/python3.10/asyncio/runners.py", line 44, in run
    return loop.run_until_complete(main)
  File "uvloop/loop.pyx", line 1518, in uvloop.loop.Loop.run_until_complete
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/server.py", line 70, in serve
    await self._serve(sockets)
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/server.py", line 77, in _serve
    config.load()
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/config.py", line 435, in load
    self.loaded_app = import_from_string(self.app)
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/importer.py", line 19, in import_from_string
    module = importlib.import_module(module_str)
  File "/usr/lib/python3.10/importlib/__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1050, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1027, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1006, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 688, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 883, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "/home/saketh/Projects/dsa/src/main.py", line 23, in <module>
    from .api import users, datasets, versioning, jobs, search, sampling, exploration, workbench, downloads
  File "/home/saketh/Projects/dsa/src/api/sampling.py", line 253
    """Perform direct sampling and return results immediately.\"""
       ^^^^^^^
SyntaxError: invalid syntax
WARNING:  WatchFiles detected changes in 'src/api/sampling.py'. Reloading...
/home/saketh/.local/lib/python3.10/site-packages/pydantic/_internal/_config.py:373: UserWarning: Valid config keys have changed in V2:
* 'schema_extra' has been renamed to 'json_schema_extra'
  warnings.warn(message, UserWarning)
Process SpawnProcess-36:
Traceback (most recent call last):
  File "/usr/lib/python3.10/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
  File "/usr/lib/python3.10/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
  File "/usr/lib/python3.10/asyncio/runners.py", line 44, in run
    return loop.run_until_complete(main)
  File "uvloop/loop.pyx", line 1518, in uvloop.loop.Loop.run_until_complete
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/server.py", line 70, in serve
    await self._serve(sockets)
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/server.py", line 77, in _serve
    config.load()
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/config.py", line 435, in load
    self.loaded_app = import_from_string(self.app)
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/importer.py", line 19, in import_from_string
    module = importlib.import_module(module_str)
  File "/usr/lib/python3.10/importlib/__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1050, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1027, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1006, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 688, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 883, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "/home/saketh/Projects/dsa/src/main.py", line 23, in <module>
    from .api import users, datasets, versioning, jobs, search, sampling, exploration, workbench, downloads
  File "/home/saketh/Projects/dsa/src/api/sampling.py", line 253
    """Perform direct sampling and return results immediately.\"""
       ^^^^^^^
SyntaxError: invalid syntax
WARNING:  WatchFiles detected changes in 'src/api/sampling.py'. Reloading...
/home/saketh/.local/lib/python3.10/site-packages/pydantic/_internal/_config.py:373: UserWarning: Valid config keys have changed in V2:
* 'schema_extra' has been renamed to 'json_schema_extra'
  warnings.warn(message, UserWarning)
Process SpawnProcess-37:
Traceback (most recent call last):
  File "/usr/lib/python3.10/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
  File "/usr/lib/python3.10/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
  File "/usr/lib/python3.10/asyncio/runners.py", line 44, in run
    return loop.run_until_complete(main)
  File "uvloop/loop.pyx", line 1518, in uvloop.loop.Loop.run_until_complete
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/server.py", line 70, in serve
    await self._serve(sockets)
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/server.py", line 77, in _serve
    config.load()
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/config.py", line 435, in load
    self.loaded_app = import_from_string(self.app)
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/importer.py", line 19, in import_from_string
    module = importlib.import_module(module_str)
  File "/usr/lib/python3.10/importlib/__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1050, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1027, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1006, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 688, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 883, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "/home/saketh/Projects/dsa/src/main.py", line 23, in <module>
    from .api import users, datasets, versioning, jobs, search, sampling, exploration, workbench, downloads
  File "/home/saketh/Projects/dsa/src/api/sampling.py", line 236
    """Perform direct sampling and return results immediately.\"""
       ^^^^^^^
SyntaxError: invalid syntax
WARNING:  WatchFiles detected changes in 'src/api/sampling.py'. Reloading...
/home/saketh/.local/lib/python3.10/site-packages/pydantic/_internal/_config.py:373: UserWarning: Valid config keys have changed in V2:
* 'schema_extra' has been renamed to 'json_schema_extra'
  warnings.warn(message, UserWarning)
Process SpawnProcess-38:
Traceback (most recent call last):
  File "/usr/lib/python3.10/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
  File "/usr/lib/python3.10/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
  File "/usr/lib/python3.10/asyncio/runners.py", line 44, in run
    return loop.run_until_complete(main)
  File "uvloop/loop.pyx", line 1518, in uvloop.loop.Loop.run_until_complete
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/server.py", line 70, in serve
    await self._serve(sockets)
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/server.py", line 77, in _serve
    config.load()
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/config.py", line 435, in load
    self.loaded_app = import_from_string(self.app)
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/importer.py", line 19, in import_from_string
    module = importlib.import_module(module_str)
  File "/usr/lib/python3.10/importlib/__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1050, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1027, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1006, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 688, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 883, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "/home/saketh/Projects/dsa/src/main.py", line 23, in <module>
    from .api import users, datasets, versioning, jobs, search, sampling, exploration, workbench, downloads
  File "/home/saketh/Projects/dsa/src/api/sampling.py", line 235
    """Perform direct sampling and return results immediately.\"""
       ^^^^^^^
SyntaxError: invalid syntax
WARNING:  WatchFiles detected changes in 'src/api/sampling.py'. Reloading...
/home/saketh/.local/lib/python3.10/site-packages/pydantic/_internal/_config.py:373: UserWarning: Valid config keys have changed in V2:
* 'schema_extra' has been renamed to 'json_schema_extra'
  warnings.warn(message, UserWarning)
Process SpawnProcess-39:
Traceback (most recent call last):
  File "/usr/lib/python3.10/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
  File "/usr/lib/python3.10/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
  File "/usr/lib/python3.10/asyncio/runners.py", line 44, in run
    return loop.run_until_complete(main)
  File "uvloop/loop.pyx", line 1518, in uvloop.loop.Loop.run_until_complete
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/server.py", line 70, in serve
    await self._serve(sockets)
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/server.py", line 77, in _serve
    config.load()
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/config.py", line 435, in load
    self.loaded_app = import_from_string(self.app)
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/importer.py", line 19, in import_from_string
    module = importlib.import_module(module_str)
  File "/usr/lib/python3.10/importlib/__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1050, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1027, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1006, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 688, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 883, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "/home/saketh/Projects/dsa/src/main.py", line 23, in <module>
    from .api import users, datasets, versioning, jobs, search, sampling, exploration, workbench, downloads
  File "/home/saketh/Projects/dsa/src/api/sampling.py", line 235
    """Perform direct sampling and return results immediately.\"""
       ^^^^^^^
SyntaxError: invalid syntax
WARNING:  WatchFiles detected changes in 'src/api/sampling.py'. Reloading...
/home/saketh/.local/lib/python3.10/site-packages/pydantic/_internal/_config.py:373: UserWarning: Valid config keys have changed in V2:
* 'schema_extra' has been renamed to 'json_schema_extra'
  warnings.warn(message, UserWarning)
Process SpawnProcess-40:
Traceback (most recent call last):
  File "/usr/lib/python3.10/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
  File "/usr/lib/python3.10/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
  File "/usr/lib/python3.10/asyncio/runners.py", line 44, in run
    return loop.run_until_complete(main)
  File "uvloop/loop.pyx", line 1518, in uvloop.loop.Loop.run_until_complete
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/server.py", line 70, in serve
    await self._serve(sockets)
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/server.py", line 77, in _serve
    config.load()
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/config.py", line 435, in load
    self.loaded_app = import_from_string(self.app)
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/importer.py", line 19, in import_from_string
    module = importlib.import_module(module_str)
  File "/usr/lib/python3.10/importlib/__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1050, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1027, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1006, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 688, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 883, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "/home/saketh/Projects/dsa/src/main.py", line 23, in <module>
    from .api import users, datasets, versioning, jobs, search, sampling, exploration, workbench, downloads
  File "/home/saketh/Projects/dsa/src/api/sampling.py", line 235
    """Perform direct sampling and return results immediately.\"""
       ^^^^^^^
SyntaxError: invalid syntax
WARNING:  WatchFiles detected changes in 'src/api/sampling.py'. Reloading...
/home/saketh/.local/lib/python3.10/site-packages/pydantic/_internal/_config.py:373: UserWarning: Valid config keys have changed in V2:
* 'schema_extra' has been renamed to 'json_schema_extra'
  warnings.warn(message, UserWarning)
Process SpawnProcess-41:
Traceback (most recent call last):
  File "/usr/lib/python3.10/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
  File "/usr/lib/python3.10/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
  File "/usr/lib/python3.10/asyncio/runners.py", line 44, in run
    return loop.run_until_complete(main)
  File "uvloop/loop.pyx", line 1518, in uvloop.loop.Loop.run_until_complete
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/server.py", line 70, in serve
    await self._serve(sockets)
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/server.py", line 77, in _serve
    config.load()
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/config.py", line 435, in load
    self.loaded_app = import_from_string(self.app)
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/importer.py", line 19, in import_from_string
    module = importlib.import_module(module_str)
  File "/usr/lib/python3.10/importlib/__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1050, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1027, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1006, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 688, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 883, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "/home/saketh/Projects/dsa/src/main.py", line 23, in <module>
    from .api import users, datasets, versioning, jobs, search, sampling, exploration, workbench, downloads
  File "/home/saketh/Projects/dsa/src/api/sampling.py", line 235
    """Perform direct sampling and return results immediately.\"""
       ^^^^^^^
SyntaxError: invalid syntax
INFO:     Stopping reloader process [33962]
