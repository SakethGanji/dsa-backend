INFO:     Will watch for changes in these directories: ['/home/saketh/Projects/dsa']
INFO:     Uvicorn running on http://127.0.0.1:8000 (Press CTRL+C to quit)
INFO:     Started reloader process [10295] using WatchFiles
/home/saketh/.local/lib/python3.10/site-packages/pydantic/_internal/_config.py:373: UserWarning: Valid config keys have changed in V2:
* 'allow_population_by_field_name' has been renamed to 'validate_by_name'
  warnings.warn(message, UserWarning)
/home/saketh/.local/lib/python3.10/site-packages/pydantic/_internal/_config.py:373: UserWarning: Valid config keys have changed in V2:
* 'schema_extra' has been renamed to 'json_schema_extra'
  warnings.warn(message, UserWarning)
INFO:src.api.error_handlers:Error handlers registered successfully
INFO:     Started server process [10298]
INFO:     Waiting for application startup.
INFO:src.main:Starting DSA Platform...
INFO:src.main:Database pool initialized
INFO:src.main:Dependencies initialized
INFO:src.workers.job_worker:Registered executor for job type: import
INFO:src.workers.job_worker:Registered executor for job type: sampling
INFO:src.workers.job_worker:Registered executor for job type: exploration
INFO:src.workers.job_worker:Registered executor for job type: sql_transform
INFO:src.main:Job worker started
INFO:src.workers.job_worker:Starting job worker...
INFO:     Application startup complete.
[1;34mUpgrade to ydata-sdk[0m
Improve your data and profiling with ydata-sdk, featuring data quality scoring, redundancy detection, outlier identification, text validation, and synthetic data generation.
Register at https://ydata.ai/register
INFO:     127.0.0.1:33726 - "POST /api/auth/login HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:36182 - "POST /api/users/login HTTP/1.1" 200 OK
INFO:     127.0.0.1:41194 - "GET /api/jobs/1121c4c0-b479-40d0-8036-6df5fde09cfc HTTP/1.1" 200 OK
INFO:     127.0.0.1:52826 - "GET /api/datasets HTTP/1.1" 307 Temporary Redirect
INFO:     127.0.0.1:48010 - "GET /api/datasets/ HTTP/1.1" 401 Unauthorized
INFO:     127.0.0.1:38420 - "GET /api/datasets/ HTTP/1.1" 200 OK
INFO:     127.0.0.1:34644 - "GET /api/jobs/00000000-0000-0000-0000-000000000000 HTTP/1.1" 401 Unauthorized
INFO:     127.0.0.1:32974 - "POST /api/users/login HTTP/1.1" 200 OK
WARNING:src.features.jobs.get_job_by_id:Job not found with ID: 00000000-0000-0000-0000-000000000000
INFO:     127.0.0.1:32980 - "GET /api/jobs/00000000-0000-0000-0000-000000000000 HTTP/1.1" 404 Not Found
WARNING:  WatchFiles detected changes in 'scripts/update_exceptions.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:src.workers.job_worker:Stopping job worker...
INFO:src.main:Database pool closed
INFO:     Application shutdown complete.
INFO:     Finished server process [10298]
/home/saketh/.local/lib/python3.10/site-packages/pydantic/_internal/_config.py:373: UserWarning: Valid config keys have changed in V2:
* 'allow_population_by_field_name' has been renamed to 'validate_by_name'
  warnings.warn(message, UserWarning)
/home/saketh/.local/lib/python3.10/site-packages/pydantic/_internal/_config.py:373: UserWarning: Valid config keys have changed in V2:
* 'schema_extra' has been renamed to 'json_schema_extra'
  warnings.warn(message, UserWarning)
INFO:src.api.error_handlers:Error handlers registered successfully
INFO:     Started server process [10484]
INFO:     Waiting for application startup.
INFO:src.main:Starting DSA Platform...
INFO:src.main:Database pool initialized
INFO:src.main:Dependencies initialized
INFO:src.workers.job_worker:Registered executor for job type: import
INFO:src.workers.job_worker:Registered executor for job type: sampling
INFO:src.workers.job_worker:Registered executor for job type: exploration
INFO:src.workers.job_worker:Registered executor for job type: sql_transform
INFO:src.main:Job worker started
INFO:src.workers.job_worker:Starting job worker...
INFO:     Application startup complete.
[1;34mUpgrade to ydata-sdk[0m
Improve your data and profiling with ydata-sdk, featuring data quality scoring, redundancy detection, outlier identification, text validation, and synthetic data generation.
Register at https://ydata.ai/register
INFO:     127.0.0.1:39632 - "GET /docs HTTP/1.1" 200 OK
/home/saketh/.local/lib/python3.10/site-packages/pydantic/_internal/_config.py:373: UserWarning: Valid config keys have changed in V2:
* 'allow_population_by_field_name' has been renamed to 'validate_by_name'
  warnings.warn(message, UserWarning)
INFO:     127.0.0.1:39632 - "GET /openapi.json HTTP/1.1" 200 OK
INFO:     127.0.0.1:54748 - "POST /api/users/token HTTP/1.1" 200 OK
INFO:     127.0.0.1:54748 - "OPTIONS /api/datasets/search/?fuzzy=true&limit=12&sort_by=relevance&sort_order=desc&include_facets=true HTTP/1.1" 200 OK
INFO:     127.0.0.1:54748 - "GET /api/datasets/search/?fuzzy=true&limit=12&sort_by=relevance&sort_order=desc&include_facets=true HTTP/1.1" 200 OK
INFO:     127.0.0.1:54748 - "OPTIONS /api/datasets/91/overview HTTP/1.1" 200 OK
INFO:     127.0.0.1:54758 - "OPTIONS /api/datasets/91/ready HTTP/1.1" 200 OK
INFO:     127.0.0.1:54758 - "GET /api/datasets/91/ready HTTP/1.1" 200 OK
INFO:     127.0.0.1:54758 - "GET /api/datasets/91/ready HTTP/1.1" 200 OK
INFO:     127.0.0.1:54758 - "GET /api/datasets/91/ready HTTP/1.1" 200 OK
INFO:     127.0.0.1:54748 - "GET /api/datasets/91/overview HTTP/1.1" 200 OK
INFO:     127.0.0.1:54772 - "OPTIONS /api/datasets/91/refs/main/tables/Electric_Vehicle_Population_Data/analysis HTTP/1.1" 200 OK
INFO:     127.0.0.1:54772 - "OPTIONS /api/datasets/91/refs/main/tables/Electric_Vehicle_Population_Data/preview HTTP/1.1" 200 OK
INFO:     127.0.0.1:54774 - "GET /api/datasets/91/refs/main/tables/Electric_Vehicle_Population_Data/preview HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:54748 - "OPTIONS /api/exploration/datasets/91/history?limit=50 HTTP/1.1" 200 OK
INFO:     127.0.0.1:54748 - "GET /api/exploration/datasets/91/history?limit=50 HTTP/1.1" 200 OK
INFO:     127.0.0.1:54772 - "GET /api/datasets/91/refs/main/tables/Electric_Vehicle_Population_Data/analysis HTTP/1.1" 200 OK
INFO:     127.0.0.1:54772 - "OPTIONS /api/datasets/102/overview HTTP/1.1" 200 OK
INFO:     127.0.0.1:54772 - "GET /api/datasets/102/overview HTTP/1.1" 200 OK
INFO:     127.0.0.1:54772 - "GET /api/datasets/91/refs/main/tables/Electric_Vehicle_Population_Data/preview HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:54748 - "GET /api/datasets/91/ready HTTP/1.1" 200 OK
INFO:     127.0.0.1:54748 - "GET /api/datasets/91/ready HTTP/1.1" 200 OK
INFO:     127.0.0.1:54748 - "GET /api/datasets/91/ready HTTP/1.1" 200 OK
INFO:     127.0.0.1:54772 - "GET /api/datasets/91/refs/main/tables/Electric_Vehicle_Population_Data/preview HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:54748 - "GET /api/datasets/91/ready HTTP/1.1" 200 OK
INFO:     127.0.0.1:54748 - "OPTIONS /api/sampling/datasets/91/history?limit=10&offset=0 HTTP/1.1" 200 OK
INFO:     127.0.0.1:54748 - "GET /api/datasets/91/ready HTTP/1.1" 200 OK
INFO:     127.0.0.1:54748 - "GET /api/sampling/datasets/91/history?limit=10&offset=0 HTTP/1.1" 200 OK
INFO:     127.0.0.1:54748 - "GET /api/datasets/91/ready HTTP/1.1" 200 OK
INFO:     127.0.0.1:51888 - "GET /api/datasets/91/refs/main/tables/Electric_Vehicle_Population_Data/preview HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:54772 - "GET /api/datasets/91/refs/main/tables/Electric_Vehicle_Population_Data/analysis HTTP/1.1" 200 OK
INFO:     127.0.0.1:54748 - "GET /api/datasets/91/ready HTTP/1.1" 200 OK
INFO:     127.0.0.1:54748 - "GET /api/datasets/91/ready HTTP/1.1" 200 OK
INFO:     127.0.0.1:54748 - "GET /api/datasets/91/ready HTTP/1.1" 200 OK
INFO:     127.0.0.1:51126 - "GET /api/datasets/91/refs/main/tables/Electric_Vehicle_Population_Data/preview HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:51140 - "GET /api/datasets/91/ready HTTP/1.1" 200 OK
INFO:     127.0.0.1:51140 - "GET /api/datasets/91/ready HTTP/1.1" 200 OK
INFO:     127.0.0.1:51140 - "GET /api/datasets/91/ready HTTP/1.1" 200 OK
INFO:     127.0.0.1:51126 - "GET /api/datasets/91/refs/main/tables/Electric_Vehicle_Population_Data/preview HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:51140 - "GET /api/datasets/91/ready HTTP/1.1" 200 OK
INFO:     127.0.0.1:51140 - "GET /api/datasets/91/ready HTTP/1.1" 200 OK
INFO:     127.0.0.1:51140 - "GET /api/datasets/91/ready HTTP/1.1" 200 OK
INFO:     127.0.0.1:51140 - "GET /api/datasets/91/ready HTTP/1.1" 200 OK
INFO:     127.0.0.1:51140 - "GET /api/datasets/91/ready HTTP/1.1" 200 OK
INFO:     127.0.0.1:51140 - "GET /api/datasets/91/ready HTTP/1.1" 200 OK
INFO:     127.0.0.1:51126 - "GET /api/datasets/91/refs/main/tables/Electric_Vehicle_Population_Data/preview HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:51126 - "GET /api/datasets/91/refs/main/tables/Electric_Vehicle_Population_Data/preview HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:40052 - "OPTIONS /api/sampling/datasets/91/jobs HTTP/1.1" 200 OK
INFO:src.core.services.sampling_service:Created sampling job 61eba976-36b0-4c94-a9e9-9c8529e65729 for dataset 91
INFO:     127.0.0.1:40052 - "POST /api/sampling/datasets/91/jobs HTTP/1.1" 200 OK
INFO:     127.0.0.1:40052 - "OPTIONS /api/jobs/61eba976-36b0-4c94-a9e9-9c8529e65729 HTTP/1.1" 200 OK
INFO:     127.0.0.1:40052 - "GET /api/jobs/61eba976-36b0-4c94-a9e9-9c8529e65729 HTTP/1.1" 200 OK
INFO:     127.0.0.1:40052 - "GET /api/jobs/61eba976-36b0-4c94-a9e9-9c8529e65729 HTTP/1.1" 200 OK
INFO:src.workers.job_worker:Processing job 61eba976-36b0-4c94-a9e9-9c8529e65729 of type sampling
INFO:src.workers.job_worker:Job parameters type: <class 'dict'>, value: {'rounds': [{'method': 'random', 'parameters': {'sample_size': 1000}, 'output_name': None}], 'user_id': 87, 'table_key': 'Electric_Vehicle_Population_Data', 'dataset_id': 91, 'commit_message': 'Multi-round sampling: 1 rounds', 'export_residual': False, 'source_commit_id': '20250708211347_46e7a3bb                                         ', 'create_output_commit': True, 'residual_output_name': None}
INFO:src.workers.sampling_executor:Starting sampling job 61eba976-36b0-4c94-a9e9-9c8529e65729 with parameters: {'rounds': [{'method': 'random', 'parameters': {'sample_size': 1000}, 'output_name': None}], 'user_id': 87, 'table_key': 'Electric_Vehicle_Population_Data', 'dataset_id': 91, 'commit_message': 'Multi-round sampling: 1 rounds', 'export_residual': False, 'source_commit_id': '20250708211347_46e7a3bb                                         ', 'create_output_commit': True, 'residual_output_name': None}
INFO:src.workers.sampling_executor:Executing sampling round 1
INFO:src.workers.sampling_executor:Round 1: random sampling with params {'sample_size': 1000}
INFO:src.workers.sampling_executor:Round 1 sampled 1000 rows
INFO:     127.0.0.1:40052 - "GET /api/jobs/61eba976-36b0-4c94-a9e9-9c8529e65729 HTTP/1.1" 200 OK
INFO:     127.0.0.1:40052 - "GET /api/jobs/61eba976-36b0-4c94-a9e9-9c8529e65729 HTTP/1.1" 200 OK
INFO:src.workers.sampling_executor:Created output commit: 460ee355d53b46f9517d40d96cd247a7396d003bd8f35536dda86791f7555ee1
INFO:src.workers.job_worker:Job 61eba976-36b0-4c94-a9e9-9c8529e65729 completed successfully
INFO:     127.0.0.1:40052 - "GET /api/jobs/61eba976-36b0-4c94-a9e9-9c8529e65729 HTTP/1.1" 200 OK
INFO:     127.0.0.1:40052 - "OPTIONS /api/sampling/jobs/61eba976-36b0-4c94-a9e9-9c8529e65729/data?limit=1&table_key=Electric_Vehicle_Population_Data HTTP/1.1" 200 OK
INFO:     127.0.0.1:40052 - "GET /api/sampling/jobs/61eba976-36b0-4c94-a9e9-9c8529e65729/data?limit=1&table_key=Electric_Vehicle_Population_Data HTTP/1.1" 200 OK
INFO:     127.0.0.1:50232 - "GET /api/sampling/datasets/91/history?limit=10&offset=0 HTTP/1.1" 200 OK
INFO:     127.0.0.1:41492 - "GET /api/datasets/search/?fuzzy=true&limit=12&sort_by=relevance&sort_order=desc&include_facets=true HTTP/1.1" 200 OK
INFO:     127.0.0.1:41502 - "OPTIONS /api/datasets/88/overview HTTP/1.1" 200 OK
INFO:     127.0.0.1:41502 - "GET /api/datasets/88/overview HTTP/1.1" 200 OK
INFO:     127.0.0.1:41502 - "OPTIONS /api/datasets/88/refs/main/tables/test_data/analysis HTTP/1.1" 200 OK
INFO:     127.0.0.1:41502 - "GET /api/datasets/88/refs/main/tables/test_data/analysis HTTP/1.1" 200 OK
INFO:     127.0.0.1:41502 - "GET /api/datasets/91/refs/main/tables/Electric_Vehicle_Population_Data/preview HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:41492 - "GET /api/datasets/91/ready HTTP/1.1" 200 OK
INFO:     127.0.0.1:41492 - "GET /api/datasets/91/ready HTTP/1.1" 200 OK
INFO:     127.0.0.1:41492 - "GET /api/datasets/91/ready HTTP/1.1" 200 OK
INFO:     127.0.0.1:41492 - "GET /api/datasets/91/ready HTTP/1.1" 200 OK
INFO:     127.0.0.1:41492 - "GET /api/datasets/91/ready HTTP/1.1" 200 OK
INFO:     127.0.0.1:41492 - "GET /api/datasets/91/ready HTTP/1.1" 200 OK
INFO:     127.0.0.1:41502 - "GET /api/datasets/91/refs/main/tables/Electric_Vehicle_Population_Data/preview HTTP/1.1" 404 Not Found
