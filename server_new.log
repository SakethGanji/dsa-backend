INFO:     Will watch for changes in these directories: ['/home/saketh/Projects/dsa']
INFO:     Uvicorn running on http://127.0.0.1:8000 (Press CTRL+C to quit)
INFO:     Started reloader process [44678] using WatchFiles
INFO:     Started server process [44681]
INFO:     Waiting for application startup.
INFO:src.main:Starting DSA Platform...
INFO:src.main:Database pool initialized
INFO:src.main:Dependencies initialized
INFO:src.workers.job_worker:Registered executor for job type: import
INFO:src.main:Job worker started
INFO:src.workers.job_worker:Starting job worker...
INFO:     Application startup complete.
INFO:     127.0.0.1:56924 - "GET /docs HTTP/1.1" 200 OK
INFO:     127.0.0.1:56924 - "GET /openapi.json HTTP/1.1" 200 OK
INFO:     127.0.0.1:37226 - "POST /api/datasets/35/refs/main/import HTTP/1.1" 200 OK
INFO:src.workers.job_worker:Processing job 45d61199-34a2-4681-8505-9446f76e9d6b of type import
INFO:src.workers.job_worker:Job parameters type: <class 'str'>, value: {"filename": "test_data.csv", "target_ref": "main", "commit_message": "Import with json parsing fix", "temp_file_path": "/tmp/import_35_test_data.csv"}
INFO:src.workers.import_executor:Import job 45d61199-34a2-4681-8505-9446f76e9d6b - parameters type: <class 'str'>, value: {"filename": "test_data.csv", "target_ref": "main", "commit_message": "Import with json parsing fix", "temp_file_path": "/tmp/import_35_test_data.csv"}
ERROR:src.workers.job_worker:Job 45d61199-34a2-4681-8505-9446f76e9d6b failed: 1 validation error for DataRow
logical_row_id
  Field required [type=missing, input_value={'sheet_name': 'test_data...0', 'city': 'New York'}}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
Traceback (most recent call last):
  File "/home/saketh/Projects/dsa/src/workers/job_worker.py", line 58, in process_job
    result = await executor.execute(job_id, parameters, self.db_pool)
  File "/home/saketh/Projects/dsa/src/workers/import_executor.py", line 53, in execute
    rows = await self._parse_file(temp_file_path, filename)
  File "/home/saketh/Projects/dsa/src/workers/import_executor.py", line 102, in _parse_file
    data_row = DataRow(
  File "/home/saketh/.local/lib/python3.10/site-packages/pydantic/main.py", line 253, in __init__
    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)
pydantic_core._pydantic_core.ValidationError: 1 validation error for DataRow
logical_row_id
  Field required [type=missing, input_value={'sheet_name': 'test_data...0', 'city': 'New York'}}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing

WARNING:  WatchFiles detected changes in 'src/workers/import_executor.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:src.workers.job_worker:Stopping job worker...
INFO:src.main:Database pool closed
INFO:     Application shutdown complete.
INFO:     Finished server process [44681]
INFO:     Started server process [44837]
INFO:     Waiting for application startup.
INFO:src.main:Starting DSA Platform...
INFO:src.main:Database pool initialized
INFO:src.main:Dependencies initialized
INFO:src.workers.job_worker:Registered executor for job type: import
INFO:src.main:Job worker started
INFO:src.workers.job_worker:Starting job worker...
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'src/workers/import_executor.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:src.workers.job_worker:Stopping job worker...
INFO:src.main:Database pool closed
INFO:     Application shutdown complete.
INFO:     Finished server process [44837]
Process SpawnProcess-3:
Traceback (most recent call last):
  File "/usr/lib/python3.10/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
  File "/usr/lib/python3.10/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
  File "/usr/lib/python3.10/asyncio/runners.py", line 44, in run
    return loop.run_until_complete(main)
  File "uvloop/loop.pyx", line 1518, in uvloop.loop.Loop.run_until_complete
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/server.py", line 70, in serve
    await self._serve(sockets)
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/server.py", line 77, in _serve
    config.load()
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/config.py", line 435, in load
    self.loaded_app = import_from_string(self.app)
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/importer.py", line 19, in import_from_string
    module = importlib.import_module(module_str)
  File "/usr/lib/python3.10/importlib/__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1050, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1027, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1006, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 688, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 883, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "/home/saketh/Projects/dsa/src/main.py", line 19, in <module>
    from .workers.import_executor import ImportJobExecutor
  File "/home/saketh/Projects/dsa/src/workers/import_executor.py", line 15, in <module>
    class ImportJobExecutor(JobExecutor):
  File "/home/saketh/Projects/dsa/src/workers/import_executor.py", line 127, in ImportJobExecutor
    async def _store_rows(self, conn, commit_id: str, rows: List[DataRow]) -> Dict[str, Any]:
NameError: name 'DataRow' is not defined
WARNING:  WatchFiles detected changes in 'src/workers/import_executor.py'. Reloading...
Process SpawnProcess-4:
Traceback (most recent call last):
  File "/usr/lib/python3.10/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
  File "/usr/lib/python3.10/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
  File "/usr/lib/python3.10/asyncio/runners.py", line 44, in run
    return loop.run_until_complete(main)
  File "uvloop/loop.pyx", line 1518, in uvloop.loop.Loop.run_until_complete
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/server.py", line 70, in serve
    await self._serve(sockets)
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/server.py", line 77, in _serve
    config.load()
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/config.py", line 435, in load
    self.loaded_app = import_from_string(self.app)
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/importer.py", line 19, in import_from_string
    module = importlib.import_module(module_str)
  File "/usr/lib/python3.10/importlib/__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1050, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1027, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1006, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 688, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 883, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "/home/saketh/Projects/dsa/src/main.py", line 19, in <module>
    from .workers.import_executor import ImportJobExecutor
  File "/home/saketh/Projects/dsa/src/workers/import_executor.py", line 15, in <module>
    class ImportJobExecutor(JobExecutor):
  File "/home/saketh/Projects/dsa/src/workers/import_executor.py", line 169, in ImportJobExecutor
    def _extract_schema(self, rows: List[DataRow]) -> Dict[str, Any]:
NameError: name 'DataRow' is not defined
WARNING:  WatchFiles detected changes in 'src/workers/import_executor.py'. Reloading...
INFO:     Started server process [45052]
INFO:     Waiting for application startup.
INFO:src.main:Starting DSA Platform...
INFO:src.main:Database pool initialized
INFO:src.main:Dependencies initialized
INFO:src.workers.job_worker:Registered executor for job type: import
INFO:src.main:Job worker started
INFO:src.workers.job_worker:Starting job worker...
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'src/workers/import_executor.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:src.workers.job_worker:Stopping job worker...
INFO:src.main:Database pool closed
INFO:     Application shutdown complete.
INFO:     Finished server process [45052]
INFO:     Started server process [45133]
INFO:     Waiting for application startup.
INFO:src.main:Starting DSA Platform...
INFO:src.main:Database pool initialized
INFO:src.main:Dependencies initialized
INFO:src.workers.job_worker:Registered executor for job type: import
INFO:src.main:Job worker started
INFO:src.workers.job_worker:Starting job worker...
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'src/workers/import_executor.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:src.workers.job_worker:Stopping job worker...
INFO:src.main:Database pool closed
INFO:     Application shutdown complete.
INFO:     Finished server process [45133]
INFO:     Started server process [45203]
INFO:     Waiting for application startup.
INFO:src.main:Starting DSA Platform...
INFO:src.main:Database pool initialized
INFO:src.main:Dependencies initialized
INFO:src.workers.job_worker:Registered executor for job type: import
INFO:src.main:Job worker started
INFO:src.workers.job_worker:Starting job worker...
INFO:     Application startup complete.
INFO:     127.0.0.1:48556 - "POST /api/datasets/35/refs/main/import HTTP/1.1" 200 OK
INFO:src.workers.job_worker:Processing job fe569d00-7bd8-49ac-a42d-57f851e8cee8 of type import
INFO:src.workers.job_worker:Job parameters type: <class 'str'>, value: {"filename": "test_data.csv", "target_ref": "main", "commit_message": "Final import test", "temp_file_path": "/tmp/import_35_test_data.csv"}
INFO:src.workers.import_executor:Import job fe569d00-7bd8-49ac-a42d-57f851e8cee8 - parameters type: <class 'str'>, value: {"filename": "test_data.csv", "target_ref": "main", "commit_message": "Final import test", "temp_file_path": "/tmp/import_35_test_data.csv"}
ERROR:src.workers.job_worker:Job fe569d00-7bd8-49ac-a42d-57f851e8cee8 failed: column "user_id" of relation "commits" does not exist
Traceback (most recent call last):
  File "/home/saketh/Projects/dsa/src/workers/job_worker.py", line 58, in process_job
    result = await executor.execute(job_id, parameters, self.db_pool)
  File "/home/saketh/Projects/dsa/src/workers/import_executor.py", line 59, in execute
    commit_id = await self._create_commit(
  File "/home/saketh/Projects/dsa/src/workers/import_executor.py", line 120, in _create_commit
    await conn.execute("""
  File "/home/saketh/.local/lib/python3.10/site-packages/asyncpg/connection.py", line 352, in execute
    _, status, _ = await self._execute(
  File "/home/saketh/.local/lib/python3.10/site-packages/asyncpg/connection.py", line 1864, in _execute
    result, _ = await self.__execute(
  File "/home/saketh/.local/lib/python3.10/site-packages/asyncpg/connection.py", line 1961, in __execute
    result, stmt = await self._do_execute(
  File "/home/saketh/.local/lib/python3.10/site-packages/asyncpg/connection.py", line 2012, in _do_execute
    stmt = await self._get_statement(
  File "/home/saketh/.local/lib/python3.10/site-packages/asyncpg/connection.py", line 432, in _get_statement
    statement = await self._protocol.prepare(
  File "asyncpg/protocol/protocol.pyx", line 165, in prepare
asyncpg.exceptions.UndefinedColumnError: column "user_id" of relation "commits" does not exist

WARNING:  WatchFiles detected changes in 'src/workers/import_executor.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:src.workers.job_worker:Stopping job worker...
INFO:src.main:Database pool closed
INFO:     Application shutdown complete.
INFO:     Finished server process [45203]
INFO:     Started server process [45281]
INFO:     Waiting for application startup.
INFO:src.main:Starting DSA Platform...
INFO:src.main:Database pool initialized
INFO:src.main:Dependencies initialized
INFO:src.workers.job_worker:Registered executor for job type: import
INFO:src.main:Job worker started
INFO:src.workers.job_worker:Starting job worker...
INFO:     Application startup complete.
INFO:     127.0.0.1:48752 - "POST /api/datasets/35/refs/main/import HTTP/1.1" 200 OK
INFO:src.workers.job_worker:Processing job 9b955dc5-cbe1-4a7e-abc6-6a72eab5feea of type import
INFO:src.workers.job_worker:Job parameters type: <class 'str'>, value: {"filename": "test_data.csv", "target_ref": "main", "commit_message": "Import with author_id fix", "temp_file_path": "/tmp/import_35_test_data.csv"}
INFO:src.workers.import_executor:Import job 9b955dc5-cbe1-4a7e-abc6-6a72eab5feea - parameters type: <class 'str'>, value: {"filename": "test_data.csv", "target_ref": "main", "commit_message": "Import with author_id fix", "temp_file_path": "/tmp/import_35_test_data.csv"}
ERROR:src.workers.job_worker:Job 9b955dc5-cbe1-4a7e-abc6-6a72eab5feea failed: column "sheet_name" of relation "rows" does not exist
Traceback (most recent call last):
  File "/home/saketh/Projects/dsa/src/workers/job_worker.py", line 58, in process_job
    result = await executor.execute(job_id, parameters, self.db_pool)
  File "/home/saketh/Projects/dsa/src/workers/import_executor.py", line 64, in execute
    stats = await self._store_rows(conn, commit_id, rows)
  File "/home/saketh/Projects/dsa/src/workers/import_executor.py", line 144, in _store_rows
    await conn.execute("""
  File "/home/saketh/.local/lib/python3.10/site-packages/asyncpg/connection.py", line 352, in execute
    _, status, _ = await self._execute(
  File "/home/saketh/.local/lib/python3.10/site-packages/asyncpg/connection.py", line 1864, in _execute
    result, _ = await self.__execute(
  File "/home/saketh/.local/lib/python3.10/site-packages/asyncpg/connection.py", line 1961, in __execute
    result, stmt = await self._do_execute(
  File "/home/saketh/.local/lib/python3.10/site-packages/asyncpg/connection.py", line 2012, in _do_execute
    stmt = await self._get_statement(
  File "/home/saketh/.local/lib/python3.10/site-packages/asyncpg/connection.py", line 432, in _get_statement
    statement = await self._protocol.prepare(
  File "asyncpg/protocol/protocol.pyx", line 165, in prepare
asyncpg.exceptions.UndefinedColumnError: column "sheet_name" of relation "rows" does not exist

WARNING:  WatchFiles detected changes in 'src/workers/import_executor.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:src.workers.job_worker:Stopping job worker...
INFO:src.main:Database pool closed
INFO:     Application shutdown complete.
INFO:     Finished server process [45281]
INFO:     Started server process [45502]
INFO:     Waiting for application startup.
INFO:src.main:Starting DSA Platform...
INFO:src.main:Database pool initialized
INFO:src.main:Dependencies initialized
INFO:src.workers.job_worker:Registered executor for job type: import
INFO:src.main:Job worker started
INFO:src.workers.job_worker:Starting job worker...
INFO:     Application startup complete.
INFO:     127.0.0.1:39640 - "POST /api/datasets/35/refs/main/import HTTP/1.1" 200 OK
INFO:src.workers.job_worker:Processing job f088d11c-9f70-47cd-b90f-2f86921dab3b of type import
INFO:src.workers.job_worker:Job parameters type: <class 'str'>, value: {"filename": "test_data.csv", "target_ref": "main", "commit_message": "Successfully importing CSV data", "temp_file_path": "/tmp/import_35_test_data.csv"}
INFO:src.workers.import_executor:Import job f088d11c-9f70-47cd-b90f-2f86921dab3b - parameters type: <class 'str'>, value: {"filename": "test_data.csv", "target_ref": "main", "commit_message": "Successfully importing CSV data", "temp_file_path": "/tmp/import_35_test_data.csv"}
ERROR:src.workers.job_worker:Job f088d11c-9f70-47cd-b90f-2f86921dab3b failed: null value in column "logical_row_id" of relation "commit_rows" violates not-null constraint
DETAIL:  Failing row contains (20250706004702_fdfb2951                                         , null, 7dc9cc99324c8922cf89d9a27955c8aff8b0717bcfd3679aaee26d4c1c84f32d).
Traceback (most recent call last):
  File "/home/saketh/Projects/dsa/src/workers/job_worker.py", line 58, in process_job
    result = await executor.execute(job_id, parameters, self.db_pool)
  File "/home/saketh/Projects/dsa/src/workers/import_executor.py", line 64, in execute
    stats = await self._store_rows(conn, commit_id, rows)
  File "/home/saketh/Projects/dsa/src/workers/import_executor.py", line 150, in _store_rows
    await conn.execute("""
  File "/home/saketh/.local/lib/python3.10/site-packages/asyncpg/connection.py", line 352, in execute
    _, status, _ = await self._execute(
  File "/home/saketh/.local/lib/python3.10/site-packages/asyncpg/connection.py", line 1864, in _execute
    result, _ = await self.__execute(
  File "/home/saketh/.local/lib/python3.10/site-packages/asyncpg/connection.py", line 1961, in __execute
    result, stmt = await self._do_execute(
  File "/home/saketh/.local/lib/python3.10/site-packages/asyncpg/connection.py", line 2027, in _do_execute
    result = await executor(stmt, timeout)
  File "asyncpg/protocol/protocol.pyx", line 206, in bind_execute
asyncpg.exceptions.NotNullViolationError: null value in column "logical_row_id" of relation "commit_rows" violates not-null constraint
DETAIL:  Failing row contains (20250706004702_fdfb2951                                         , null, 7dc9cc99324c8922cf89d9a27955c8aff8b0717bcfd3679aaee26d4c1c84f32d).

WARNING:  WatchFiles detected changes in 'src/workers/import_executor.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:src.workers.job_worker:Stopping job worker...
INFO:src.main:Database pool closed
INFO:     Application shutdown complete.
INFO:     Finished server process [45502]
INFO:     Started server process [45645]
INFO:     Waiting for application startup.
INFO:src.main:Starting DSA Platform...
INFO:src.main:Database pool initialized
INFO:src.main:Dependencies initialized
INFO:src.workers.job_worker:Registered executor for job type: import
INFO:src.main:Job worker started
INFO:src.workers.job_worker:Starting job worker...
INFO:     Application startup complete.
INFO:     127.0.0.1:50016 - "POST /api/datasets/35/refs/main/import HTTP/1.1" 200 OK
INFO:src.workers.job_worker:Processing job 12090e3b-fb02-4e46-939b-744f87ce9b3c of type import
INFO:src.workers.job_worker:Job parameters type: <class 'str'>, value: {"filename": "test_data.csv", "target_ref": "main", "commit_message": "First successful import\\!", "temp_file_path": "/tmp/import_35_test_data.csv"}
INFO:src.workers.import_executor:Import job 12090e3b-fb02-4e46-939b-744f87ce9b3c - parameters type: <class 'str'>, value: {"filename": "test_data.csv", "target_ref": "main", "commit_message": "First successful import\\!", "temp_file_path": "/tmp/import_35_test_data.csv"}
ERROR:src.workers.job_worker:Job 12090e3b-fb02-4e46-939b-744f87ce9b3c failed: column "schema_data" of relation "commit_schemas" does not exist
Traceback (most recent call last):
  File "/home/saketh/Projects/dsa/src/workers/job_worker.py", line 58, in process_job
    result = await executor.execute(job_id, parameters, self.db_pool)
  File "/home/saketh/Projects/dsa/src/workers/import_executor.py", line 68, in execute
    await self._store_schema(conn, commit_id, schema)
  File "/home/saketh/Projects/dsa/src/workers/import_executor.py", line 182, in _store_schema
    await conn.execute("""
  File "/home/saketh/.local/lib/python3.10/site-packages/asyncpg/connection.py", line 352, in execute
    _, status, _ = await self._execute(
  File "/home/saketh/.local/lib/python3.10/site-packages/asyncpg/connection.py", line 1864, in _execute
    result, _ = await self.__execute(
  File "/home/saketh/.local/lib/python3.10/site-packages/asyncpg/connection.py", line 1961, in __execute
    result, stmt = await self._do_execute(
  File "/home/saketh/.local/lib/python3.10/site-packages/asyncpg/connection.py", line 2012, in _do_execute
    stmt = await self._get_statement(
  File "/home/saketh/.local/lib/python3.10/site-packages/asyncpg/connection.py", line 432, in _get_statement
    statement = await self._protocol.prepare(
  File "asyncpg/protocol/protocol.pyx", line 165, in prepare
asyncpg.exceptions.UndefinedColumnError: column "schema_data" of relation "commit_schemas" does not exist

WARNING:  WatchFiles detected changes in 'src/workers/import_executor.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:src.workers.job_worker:Stopping job worker...
INFO:src.main:Database pool closed
INFO:     Application shutdown complete.
INFO:     Finished server process [45645]
INFO:     Started server process [45928]
INFO:     Waiting for application startup.
INFO:src.main:Starting DSA Platform...
INFO:src.main:Database pool initialized
INFO:src.main:Dependencies initialized
INFO:src.workers.job_worker:Registered executor for job type: import
INFO:src.main:Job worker started
INFO:src.workers.job_worker:Starting job worker...
INFO:     Application startup complete.
INFO:     127.0.0.1:56222 - "POST /api/datasets/35/refs/main/import HTTP/1.1" 200 OK
INFO:src.workers.job_worker:Processing job beb1aa8e-9975-4a10-b4c3-ab5e99132d05 of type import
INFO:src.workers.job_worker:Job parameters type: <class 'str'>, value: {"filename": "test_data.csv", "target_ref": "main", "commit_message": "Import complete with all fixes", "temp_file_path": "/tmp/import_35_test_data.csv"}
INFO:src.workers.import_executor:Import job beb1aa8e-9975-4a10-b4c3-ab5e99132d05 - parameters type: <class 'str'>, value: {"filename": "test_data.csv", "target_ref": "main", "commit_message": "Import complete with all fixes", "temp_file_path": "/tmp/import_35_test_data.csv"}
ERROR:src.workers.job_worker:Job beb1aa8e-9975-4a10-b4c3-ab5e99132d05 failed: column "ref_name" does not exist
Traceback (most recent call last):
  File "/home/saketh/Projects/dsa/src/workers/job_worker.py", line 58, in process_job
    result = await executor.execute(job_id, parameters, self.db_pool)
  File "/home/saketh/Projects/dsa/src/workers/import_executor.py", line 71, in execute
    await self._update_ref(conn, dataset_id, target_ref, commit_id)
  File "/home/saketh/Projects/dsa/src/workers/import_executor.py", line 189, in _update_ref
    await conn.execute("""
  File "/home/saketh/.local/lib/python3.10/site-packages/asyncpg/connection.py", line 352, in execute
    _, status, _ = await self._execute(
  File "/home/saketh/.local/lib/python3.10/site-packages/asyncpg/connection.py", line 1864, in _execute
    result, _ = await self.__execute(
  File "/home/saketh/.local/lib/python3.10/site-packages/asyncpg/connection.py", line 1961, in __execute
    result, stmt = await self._do_execute(
  File "/home/saketh/.local/lib/python3.10/site-packages/asyncpg/connection.py", line 2012, in _do_execute
    stmt = await self._get_statement(
  File "/home/saketh/.local/lib/python3.10/site-packages/asyncpg/connection.py", line 432, in _get_statement
    statement = await self._protocol.prepare(
  File "asyncpg/protocol/protocol.pyx", line 165, in prepare
asyncpg.exceptions.UndefinedColumnError: column "ref_name" does not exist

WARNING:  WatchFiles detected changes in 'src/workers/import_executor.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:src.workers.job_worker:Stopping job worker...
INFO:src.main:Database pool closed
INFO:     Application shutdown complete.
INFO:     Finished server process [45928]
INFO:     Started server process [46037]
INFO:     Waiting for application startup.
INFO:src.main:Starting DSA Platform...
INFO:src.main:Database pool initialized
INFO:src.main:Dependencies initialized
INFO:src.workers.job_worker:Registered executor for job type: import
INFO:src.main:Job worker started
INFO:src.workers.job_worker:Starting job worker...
INFO:     Application startup complete.
INFO:     127.0.0.1:47250 - "POST /api/datasets/35/refs/main/import HTTP/1.1" 200 OK
INFO:src.workers.job_worker:Processing job 3500381c-ce63-4690-8144-cf9eaf9c174a of type import
INFO:src.workers.job_worker:Job parameters type: <class 'str'>, value: {"filename": "test_data.csv", "target_ref": "main", "commit_message": "Final successful import", "temp_file_path": "/tmp/import_35_test_data.csv"}
INFO:src.workers.import_executor:Import job 3500381c-ce63-4690-8144-cf9eaf9c174a - parameters type: <class 'str'>, value: {"filename": "test_data.csv", "target_ref": "main", "commit_message": "Final successful import", "temp_file_path": "/tmp/import_35_test_data.csv"}
ERROR:src.workers.job_worker:Job 3500381c-ce63-4690-8144-cf9eaf9c174a failed: column "sheet_names" of relation "commit_statistics" does not exist
Traceback (most recent call last):
  File "/home/saketh/Projects/dsa/src/workers/job_worker.py", line 58, in process_job
    result = await executor.execute(job_id, parameters, self.db_pool)
  File "/home/saketh/Projects/dsa/src/workers/import_executor.py", line 74, in execute
    await self._store_statistics(conn, commit_id, stats)
  File "/home/saketh/Projects/dsa/src/workers/import_executor.py", line 197, in _store_statistics
    await conn.execute("""
  File "/home/saketh/.local/lib/python3.10/site-packages/asyncpg/connection.py", line 352, in execute
    _, status, _ = await self._execute(
  File "/home/saketh/.local/lib/python3.10/site-packages/asyncpg/connection.py", line 1864, in _execute
    result, _ = await self.__execute(
  File "/home/saketh/.local/lib/python3.10/site-packages/asyncpg/connection.py", line 1961, in __execute
    result, stmt = await self._do_execute(
  File "/home/saketh/.local/lib/python3.10/site-packages/asyncpg/connection.py", line 2012, in _do_execute
    stmt = await self._get_statement(
  File "/home/saketh/.local/lib/python3.10/site-packages/asyncpg/connection.py", line 432, in _get_statement
    statement = await self._protocol.prepare(
  File "asyncpg/protocol/protocol.pyx", line 165, in prepare
asyncpg.exceptions.UndefinedColumnError: column "sheet_names" of relation "commit_statistics" does not exist

WARNING:  WatchFiles detected changes in 'src/workers/import_executor.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:src.workers.job_worker:Stopping job worker...
INFO:src.main:Database pool closed
INFO:     Application shutdown complete.
INFO:     Finished server process [46037]
INFO:     Started server process [46130]
INFO:     Waiting for application startup.
INFO:src.main:Starting DSA Platform...
INFO:src.main:Database pool initialized
INFO:src.main:Dependencies initialized
INFO:src.workers.job_worker:Registered executor for job type: import
INFO:src.main:Job worker started
INFO:src.workers.job_worker:Starting job worker...
INFO:     Application startup complete.
INFO:     127.0.0.1:37732 - "POST /api/datasets/35/refs/main/import HTTP/1.1" 200 OK
INFO:src.workers.job_worker:Processing job ca5f7897-a771-4bb7-b167-c8e71fa06224 of type import
INFO:src.workers.job_worker:Job parameters type: <class 'str'>, value: {"filename": "test_data.csv", "target_ref": "main", "commit_message": "Import test data successfully\\!", "temp_file_path": "/tmp/import_35_test_data.csv"}
INFO:src.workers.import_executor:Import job ca5f7897-a771-4bb7-b167-c8e71fa06224 - parameters type: <class 'str'>, value: {"filename": "test_data.csv", "target_ref": "main", "commit_message": "Import test data successfully\\!", "temp_file_path": "/tmp/import_35_test_data.csv"}
INFO:src.workers.job_worker:Job ca5f7897-a771-4bb7-b167-c8e71fa06224 completed successfully
WARNING:  WatchFiles detected changes in 'src/features/jobs/__init__.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:src.workers.job_worker:Stopping job worker...
INFO:src.main:Database pool closed
INFO:     Application shutdown complete.
INFO:     Finished server process [46130]
INFO:     Started server process [46384]
INFO:     Waiting for application startup.
INFO:src.main:Starting DSA Platform...
INFO:src.main:Database pool initialized
INFO:src.main:Dependencies initialized
INFO:src.workers.job_worker:Registered executor for job type: import
INFO:src.main:Job worker started
INFO:src.workers.job_worker:Starting job worker...
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'src/features/jobs/__init__.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:src.workers.job_worker:Stopping job worker...
INFO:src.main:Database pool closed
INFO:     Application shutdown complete.
INFO:     Finished server process [46384]
INFO:     Started server process [46449]
INFO:     Waiting for application startup.
INFO:src.main:Starting DSA Platform...
INFO:src.main:Database pool initialized
INFO:src.main:Dependencies initialized
INFO:src.workers.job_worker:Registered executor for job type: import
INFO:src.main:Job worker started
INFO:src.workers.job_worker:Starting job worker...
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'src/features/jobs/get_jobs.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:src.workers.job_worker:Stopping job worker...
INFO:src.main:Database pool closed
INFO:     Application shutdown complete.
INFO:     Finished server process [46449]
INFO:     Started server process [46505]
INFO:     Waiting for application startup.
INFO:src.main:Starting DSA Platform...
INFO:src.main:Database pool initialized
INFO:src.main:Dependencies initialized
INFO:src.workers.job_worker:Registered executor for job type: import
INFO:src.main:Job worker started
INFO:src.workers.job_worker:Starting job worker...
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'src/features/jobs/get_job_by_id.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:src.workers.job_worker:Stopping job worker...
INFO:src.main:Database pool closed
INFO:     Application shutdown complete.
INFO:     Finished server process [46505]
INFO:     Started server process [46550]
INFO:     Waiting for application startup.
INFO:src.main:Starting DSA Platform...
INFO:src.main:Database pool initialized
INFO:src.main:Dependencies initialized
INFO:src.workers.job_worker:Registered executor for job type: import
INFO:src.main:Job worker started
INFO:src.workers.job_worker:Starting job worker...
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'src/api/jobs.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:src.workers.job_worker:Stopping job worker...
INFO:src.main:Database pool closed
INFO:     Application shutdown complete.
INFO:     Finished server process [46550]
INFO:     Started server process [46637]
INFO:     Waiting for application startup.
INFO:src.main:Starting DSA Platform...
INFO:src.main:Database pool initialized
INFO:src.main:Dependencies initialized
INFO:src.workers.job_worker:Registered executor for job type: import
INFO:src.main:Job worker started
INFO:src.workers.job_worker:Starting job worker...
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'src/models/pydantic_models.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:src.workers.job_worker:Stopping job worker...
INFO:src.main:Database pool closed
INFO:     Application shutdown complete.
INFO:     Finished server process [46637]
INFO:     Started server process [46683]
INFO:     Waiting for application startup.
INFO:src.main:Starting DSA Platform...
INFO:src.main:Database pool initialized
INFO:src.main:Dependencies initialized
INFO:src.workers.job_worker:Registered executor for job type: import
INFO:src.main:Job worker started
INFO:src.workers.job_worker:Starting job worker...
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'src/main.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:src.workers.job_worker:Stopping job worker...
INFO:src.main:Database pool closed
INFO:     Application shutdown complete.
INFO:     Finished server process [46683]
INFO:     Started server process [46731]
INFO:     Waiting for application startup.
INFO:src.main:Starting DSA Platform...
INFO:src.main:Database pool initialized
INFO:src.main:Dependencies initialized
INFO:src.workers.job_worker:Registered executor for job type: import
INFO:src.main:Job worker started
INFO:src.workers.job_worker:Starting job worker...
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'src/main.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:src.workers.job_worker:Stopping job worker...
INFO:src.main:Database pool closed
INFO:     Application shutdown complete.
INFO:     Finished server process [46731]
INFO:     Started server process [46797]
INFO:     Waiting for application startup.
INFO:src.main:Starting DSA Platform...
INFO:src.main:Database pool initialized
INFO:src.main:Dependencies initialized
INFO:src.workers.job_worker:Registered executor for job type: import
INFO:src.main:Job worker started
INFO:src.workers.job_worker:Starting job worker...
INFO:     Application startup complete.
INFO:     127.0.0.1:58274 - "GET /api/jobs HTTP/1.1" 500 Internal Server Error
ERROR:    Exception in ASGI application
Traceback (most recent call last):
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/protocols/http/httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/middleware/errors.py", line 187, in __call__
    raise exc
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
  File "/home/saketh/.local/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
  File "/home/saketh/.local/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
  File "/home/saketh/Projects/dsa/src/api/jobs.py", line 46, in get_jobs
    result = await handler.handle(
  File "/home/saketh/Projects/dsa/src/features/jobs/get_jobs.py", line 41, in handle
    async with self._uow.acquire() as conn:
AttributeError: 'PostgresUnitOfWork' object has no attribute 'acquire'
WARNING:  WatchFiles detected changes in 'src/features/jobs/get_jobs.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:src.workers.job_worker:Stopping job worker...
INFO:src.main:Database pool closed
INFO:     Application shutdown complete.
INFO:     Finished server process [46797]
Process SpawnProcess-22:
Traceback (most recent call last):
  File "/usr/lib/python3.10/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
  File "/usr/lib/python3.10/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
  File "/usr/lib/python3.10/asyncio/runners.py", line 44, in run
    return loop.run_until_complete(main)
  File "uvloop/loop.pyx", line 1518, in uvloop.loop.Loop.run_until_complete
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/server.py", line 70, in serve
    await self._serve(sockets)
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/server.py", line 77, in _serve
    config.load()
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/config.py", line 435, in load
    self.loaded_app = import_from_string(self.app)
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/importer.py", line 19, in import_from_string
    module = importlib.import_module(module_str)
  File "/usr/lib/python3.10/importlib/__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1050, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1027, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1006, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 688, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 883, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "/home/saketh/Projects/dsa/src/main.py", line 17, in <module>
    from .api import users, datasets, versioning, jobs
  File "/home/saketh/Projects/dsa/src/api/jobs.py", line 8, in <module>
    from src.features.jobs.get_jobs import GetJobsHandler
  File "/home/saketh/Projects/dsa/src/features/jobs/get_jobs.py", line 43
    query = """
IndentationError: unexpected indent
WARNING:  WatchFiles detected changes in 'src/features/jobs/get_job_by_id.py'. Reloading...
Process SpawnProcess-23:
Traceback (most recent call last):
  File "/usr/lib/python3.10/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
  File "/usr/lib/python3.10/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
  File "/usr/lib/python3.10/asyncio/runners.py", line 44, in run
    return loop.run_until_complete(main)
  File "uvloop/loop.pyx", line 1518, in uvloop.loop.Loop.run_until_complete
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/server.py", line 70, in serve
    await self._serve(sockets)
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/server.py", line 77, in _serve
    config.load()
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/config.py", line 435, in load
    self.loaded_app = import_from_string(self.app)
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/importer.py", line 19, in import_from_string
    module = importlib.import_module(module_str)
  File "/usr/lib/python3.10/importlib/__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1050, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1027, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1006, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 688, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 883, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "/home/saketh/Projects/dsa/src/main.py", line 17, in <module>
    from .api import users, datasets, versioning, jobs
  File "/home/saketh/Projects/dsa/src/api/jobs.py", line 8, in <module>
    from src.features.jobs.get_jobs import GetJobsHandler
  File "/home/saketh/Projects/dsa/src/features/jobs/get_jobs.py", line 43
    query = """
IndentationError: unexpected indent
WARNING:  WatchFiles detected changes in 'src/worker/tasks.py'. Reloading...
Process SpawnProcess-24:
Traceback (most recent call last):
  File "/usr/lib/python3.10/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
  File "/usr/lib/python3.10/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
  File "/usr/lib/python3.10/asyncio/runners.py", line 44, in run
    return loop.run_until_complete(main)
  File "uvloop/loop.pyx", line 1518, in uvloop.loop.Loop.run_until_complete
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/server.py", line 70, in serve
    await self._serve(sockets)
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/server.py", line 77, in _serve
    config.load()
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/config.py", line 435, in load
    self.loaded_app = import_from_string(self.app)
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/importer.py", line 19, in import_from_string
    module = importlib.import_module(module_str)
  File "/usr/lib/python3.10/importlib/__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1050, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1027, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1006, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 688, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 883, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "/home/saketh/Projects/dsa/src/main.py", line 17, in <module>
    from .api import users, datasets, versioning, jobs
  File "/home/saketh/Projects/dsa/src/api/jobs.py", line 8, in <module>
    from src.features.jobs.get_jobs import GetJobsHandler
  File "/home/saketh/Projects/dsa/src/features/jobs/get_jobs.py", line 43
    query = """
IndentationError: unexpected indent
WARNING:  WatchFiles detected changes in 'src/features/jobs/get_jobs.py'. Reloading...
Process SpawnProcess-25:
Traceback (most recent call last):
  File "/usr/lib/python3.10/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
  File "/usr/lib/python3.10/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
  File "/usr/lib/python3.10/asyncio/runners.py", line 44, in run
    return loop.run_until_complete(main)
  File "uvloop/loop.pyx", line 1518, in uvloop.loop.Loop.run_until_complete
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/server.py", line 70, in serve
    await self._serve(sockets)
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/server.py", line 77, in _serve
    config.load()
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/config.py", line 435, in load
    self.loaded_app = import_from_string(self.app)
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/importer.py", line 19, in import_from_string
    module = importlib.import_module(module_str)
  File "/usr/lib/python3.10/importlib/__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1050, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1027, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1006, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 688, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 883, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "/home/saketh/Projects/dsa/src/main.py", line 17, in <module>
    from .api import users, datasets, versioning, jobs
  File "/home/saketh/Projects/dsa/src/api/jobs.py", line 8, in <module>
    from src.features.jobs.get_jobs import GetJobsHandler
  File "/home/saketh/Projects/dsa/src/features/jobs/get_jobs.py", line 62
    params = []
IndentationError: unexpected indent
WARNING:  WatchFiles detected changes in 'src/features/jobs/get_job_by_id.py'. Reloading...
Process SpawnProcess-26:
Traceback (most recent call last):
  File "/usr/lib/python3.10/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
  File "/usr/lib/python3.10/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
  File "/usr/lib/python3.10/asyncio/runners.py", line 44, in run
    return loop.run_until_complete(main)
  File "uvloop/loop.pyx", line 1518, in uvloop.loop.Loop.run_until_complete
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/server.py", line 70, in serve
    await self._serve(sockets)
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/server.py", line 77, in _serve
    config.load()
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/config.py", line 435, in load
    self.loaded_app = import_from_string(self.app)
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/importer.py", line 19, in import_from_string
    module = importlib.import_module(module_str)
  File "/usr/lib/python3.10/importlib/__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1050, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1027, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1006, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 688, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 883, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "/home/saketh/Projects/dsa/src/main.py", line 17, in <module>
    from .api import users, datasets, versioning, jobs
  File "/home/saketh/Projects/dsa/src/api/jobs.py", line 8, in <module>
    from src.features.jobs.get_jobs import GetJobsHandler
  File "/home/saketh/Projects/dsa/src/features/jobs/get_jobs.py", line 62
    params = []
IndentationError: unexpected indent
WARNING:  WatchFiles detected changes in 'src/features/jobs/get_jobs.py'. Reloading...
Process SpawnProcess-27:
Traceback (most recent call last):
  File "/usr/lib/python3.10/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
  File "/usr/lib/python3.10/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
  File "/usr/lib/python3.10/asyncio/runners.py", line 44, in run
    return loop.run_until_complete(main)
  File "uvloop/loop.pyx", line 1518, in uvloop.loop.Loop.run_until_complete
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/server.py", line 70, in serve
    await self._serve(sockets)
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/server.py", line 77, in _serve
    config.load()
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/config.py", line 435, in load
    self.loaded_app = import_from_string(self.app)
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/importer.py", line 19, in import_from_string
    module = importlib.import_module(module_str)
  File "/usr/lib/python3.10/importlib/__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1050, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1027, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1006, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 688, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 883, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "/home/saketh/Projects/dsa/src/main.py", line 17, in <module>
    from .api import users, datasets, versioning, jobs
  File "/home/saketh/Projects/dsa/src/api/jobs.py", line 8, in <module>
    from src.features.jobs.get_jobs import GetJobsHandler
  File "/home/saketh/Projects/dsa/src/features/jobs/get_jobs.py", line 66
    if user_id is not None:
IndentationError: unexpected indent
WARNING:  WatchFiles detected changes in 'src/features/jobs/get_jobs.py'. Reloading...
Process SpawnProcess-28:
Traceback (most recent call last):
  File "/usr/lib/python3.10/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
  File "/usr/lib/python3.10/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
  File "/usr/lib/python3.10/asyncio/runners.py", line 44, in run
    return loop.run_until_complete(main)
  File "uvloop/loop.pyx", line 1518, in uvloop.loop.Loop.run_until_complete
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/server.py", line 70, in serve
    await self._serve(sockets)
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/server.py", line 77, in _serve
    config.load()
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/config.py", line 435, in load
    self.loaded_app = import_from_string(self.app)
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/importer.py", line 19, in import_from_string
    module = importlib.import_module(module_str)
  File "/usr/lib/python3.10/importlib/__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1050, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1027, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1006, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 688, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 883, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "/home/saketh/Projects/dsa/src/main.py", line 17, in <module>
    from .api import users, datasets, versioning, jobs
  File "/home/saketh/Projects/dsa/src/api/jobs.py", line 9, in <module>
    from src.features.jobs.get_job_by_id import GetJobByIdHandler
  File "/home/saketh/Projects/dsa/src/features/jobs/get_job_by_id.py", line 57
    row = await conn.fetchrow(query, job_id)
IndentationError: unexpected indent
WARNING:  WatchFiles detected changes in 'src/features/jobs/get_jobs.py'. Reloading...
Process SpawnProcess-29:
Traceback (most recent call last):
  File "/usr/lib/python3.10/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
  File "/usr/lib/python3.10/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
  File "/usr/lib/python3.10/asyncio/runners.py", line 44, in run
    return loop.run_until_complete(main)
  File "uvloop/loop.pyx", line 1518, in uvloop.loop.Loop.run_until_complete
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/server.py", line 70, in serve
    await self._serve(sockets)
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/server.py", line 77, in _serve
    config.load()
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/config.py", line 435, in load
    self.loaded_app = import_from_string(self.app)
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/importer.py", line 19, in import_from_string
    module = importlib.import_module(module_str)
  File "/usr/lib/python3.10/importlib/__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1050, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1027, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1006, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 688, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 883, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "/home/saketh/Projects/dsa/src/main.py", line 17, in <module>
    from .api import users, datasets, versioning, jobs
  File "/home/saketh/Projects/dsa/src/api/jobs.py", line 9, in <module>
    from src.features.jobs.get_job_by_id import GetJobByIdHandler
  File "/home/saketh/Projects/dsa/src/features/jobs/get_job_by_id.py", line 57
    row = await conn.fetchrow(query, job_id)
IndentationError: unexpected indent
WARNING:  WatchFiles detected changes in 'src/features/jobs/get_job_by_id.py'. Reloading...
INFO:     Started server process [47864]
INFO:     Waiting for application startup.
INFO:src.main:Starting DSA Platform...
INFO:src.main:Database pool initialized
INFO:src.main:Dependencies initialized
INFO:src.workers.job_worker:Registered executor for job type: import
INFO:src.main:Job worker started
INFO:src.workers.job_worker:Starting job worker...
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'src/features/jobs/get_job_by_id.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:src.workers.job_worker:Stopping job worker...
INFO:src.main:Database pool closed
INFO:     Application shutdown complete.
INFO:     Finished server process [47864]
Process SpawnProcess-31:
Traceback (most recent call last):
  File "/usr/lib/python3.10/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
  File "/usr/lib/python3.10/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
  File "/usr/lib/python3.10/asyncio/runners.py", line 44, in run
    return loop.run_until_complete(main)
  File "uvloop/loop.pyx", line 1518, in uvloop.loop.Loop.run_until_complete
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/server.py", line 70, in serve
    await self._serve(sockets)
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/server.py", line 77, in _serve
    config.load()
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/config.py", line 435, in load
    self.loaded_app = import_from_string(self.app)
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/importer.py", line 19, in import_from_string
    module = importlib.import_module(module_str)
  File "/usr/lib/python3.10/importlib/__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1050, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1027, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1006, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 688, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 883, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "/home/saketh/Projects/dsa/src/main.py", line 17, in <module>
    from .api import users, datasets, versioning, jobs
  File "/home/saketh/Projects/dsa/src/api/jobs.py", line 9, in <module>
    from src.features.jobs.get_job_by_id import GetJobByIdHandler
  File "/home/saketh/Projects/dsa/src/features/jobs/get_job_by_id.py", line 80
    return job
IndentationError: unexpected indent
WARNING:  WatchFiles detected changes in 'src/features/jobs/get_job_by_id.py'. Reloading...
Process SpawnProcess-32:
Traceback (most recent call last):
  File "/usr/lib/python3.10/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
  File "/usr/lib/python3.10/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
  File "/usr/lib/python3.10/asyncio/runners.py", line 44, in run
    return loop.run_until_complete(main)
  File "uvloop/loop.pyx", line 1518, in uvloop.loop.Loop.run_until_complete
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/server.py", line 70, in serve
    await self._serve(sockets)
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/server.py", line 77, in _serve
    config.load()
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/config.py", line 435, in load
    self.loaded_app = import_from_string(self.app)
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/importer.py", line 19, in import_from_string
    module = importlib.import_module(module_str)
  File "/usr/lib/python3.10/importlib/__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1050, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1027, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1006, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 688, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 883, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "/home/saketh/Projects/dsa/src/main.py", line 17, in <module>
    from .api import users, datasets, versioning, jobs
  File "/home/saketh/Projects/dsa/src/api/jobs.py", line 9, in <module>
    from src.features.jobs.get_job_by_id import GetJobByIdHandler
  File "/home/saketh/Projects/dsa/src/features/jobs/get_job_by_id.py", line 80
    return job
IndentationError: unexpected indent
WARNING:  WatchFiles detected changes in 'src/features/jobs/get_job_by_id.py'. Reloading...
INFO:     Started server process [48064]
INFO:     Waiting for application startup.
INFO:src.main:Starting DSA Platform...
INFO:src.main:Database pool initialized
INFO:src.main:Dependencies initialized
INFO:src.workers.job_worker:Registered executor for job type: import
INFO:src.main:Job worker started
INFO:src.workers.job_worker:Starting job worker...
INFO:     Application startup complete.
INFO:     127.0.0.1:45144 - "GET /api/jobs HTTP/1.1" 200 OK
INFO:     127.0.0.1:54022 - "GET /api/jobs?status=completed HTTP/1.1" 200 OK
INFO:     127.0.0.1:53746 - "GET /api/jobs/ca5f7897-a771-4bb7-b167-c8e71fa06224 HTTP/1.1" 500 Internal Server Error
ERROR:    Exception in ASGI application
Traceback (most recent call last):
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/protocols/http/httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/middleware/errors.py", line 187, in __call__
    raise exc
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
  File "/home/saketh/.local/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
  File "/home/saketh/.local/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
  File "/home/saketh/Projects/dsa/src/api/jobs.py", line 101, in get_job_by_id
    return JobDetail(
  File "/home/saketh/.local/lib/python3.10/site-packages/pydantic/main.py", line 253, in __init__
    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)
pydantic_core._pydantic_core.ValidationError: 2 validation errors for JobDetail
run_parameters
  Input should be a valid dictionary [type=dict_type, input_value='{"filename": "test_data....port_35_test_data.csv"}', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/dict_type
output_summary
  Input should be a valid dictionary [type=dict_type, input_value='{"message": "Successfull...7", "rows_imported": 5}', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/dict_type
WARNING:  WatchFiles detected changes in 'src/features/jobs/get_job_by_id.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:src.workers.job_worker:Stopping job worker...
INFO:src.main:Database pool closed
INFO:     Application shutdown complete.
INFO:     Finished server process [48064]
INFO:     Started server process [48213]
INFO:     Waiting for application startup.
INFO:src.main:Starting DSA Platform...
INFO:src.main:Database pool initialized
INFO:src.main:Dependencies initialized
INFO:src.workers.job_worker:Registered executor for job type: import
INFO:src.main:Job worker started
INFO:src.workers.job_worker:Starting job worker...
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'src/features/jobs/get_job_by_id.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:src.workers.job_worker:Stopping job worker...
INFO:src.main:Database pool closed
INFO:     Application shutdown complete.
INFO:     Finished server process [48213]
INFO:     Started server process [48288]
INFO:     Waiting for application startup.
INFO:src.main:Starting DSA Platform...
INFO:src.main:Database pool initialized
INFO:src.main:Dependencies initialized
INFO:src.workers.job_worker:Registered executor for job type: import
INFO:src.main:Job worker started
INFO:src.workers.job_worker:Starting job worker...
INFO:     Application startup complete.
INFO:     127.0.0.1:50352 - "GET /api/jobs/ca5f7897-a771-4bb7-b167-c8e71fa06224 HTTP/1.1" 200 OK
INFO:     127.0.0.1:37150 - "GET /api/jobs?user_soeid=bg54677 HTTP/1.1" 500 Internal Server Error
ERROR:    Exception in ASGI application
Traceback (most recent call last):
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/protocols/http/httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/middleware/errors.py", line 187, in __call__
    raise exc
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
  File "/home/saketh/.local/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
  File "/home/saketh/.local/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
  File "/home/saketh/Projects/dsa/src/api/jobs.py", line 38, in get_jobs
    async with uow.acquire() as conn:
AttributeError: 'PostgresUnitOfWork' object has no attribute 'acquire'
WARNING:  WatchFiles detected changes in 'src/api/jobs.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:src.workers.job_worker:Stopping job worker...
INFO:src.main:Database pool closed
INFO:     Application shutdown complete.
INFO:     Finished server process [48288]
INFO:     Started server process [48347]
INFO:     Waiting for application startup.
INFO:src.main:Starting DSA Platform...
INFO:src.main:Database pool initialized
INFO:src.main:Dependencies initialized
INFO:src.workers.job_worker:Registered executor for job type: import
INFO:src.main:Job worker started
INFO:src.workers.job_worker:Starting job worker...
INFO:     Application startup complete.
INFO:     127.0.0.1:48774 - "GET /api/jobs?user_soeid=bg54677 HTTP/1.1" 200 OK
INFO:     127.0.0.1:41606 - "GET /docs HTTP/1.1" 200 OK
INFO:     127.0.0.1:41606 - "GET /openapi.json HTTP/1.1" 200 OK
INFO:     127.0.0.1:41616 - "POST /api/users/login HTTP/1.1" 200 OK
INFO:     127.0.0.1:41616 - "GET /api/datasets/?offset=0&limit=100 HTTP/1.1" 200 OK
INFO:     127.0.0.1:47142 - "POST /api/datasets/35/refs/main/import HTTP/1.1" 200 OK
INFO:src.workers.job_worker:Processing job 53ff7a92-d3c5-4e37-b83b-2c27c0b893b8 of type import
INFO:src.workers.job_worker:Job parameters type: <class 'str'>, value: {"filename": "manifest.csv", "target_ref": "main", "commit_message": "string", "temp_file_path": "/tmp/import_35_manifest.csv"}
INFO:src.workers.import_executor:Import job 53ff7a92-d3c5-4e37-b83b-2c27c0b893b8 - parameters type: <class 'str'>, value: {"filename": "manifest.csv", "target_ref": "main", "commit_message": "string", "temp_file_path": "/tmp/import_35_manifest.csv"}
INFO:src.workers.job_worker:Job 53ff7a92-d3c5-4e37-b83b-2c27c0b893b8 completed successfully
INFO:     127.0.0.1:36288 - "POST /api/datasets/35/refs/main/import HTTP/1.1" 200 OK
INFO:src.workers.job_worker:Processing job e0e53645-f5d6-45e8-acd0-7a793b387201 of type import
INFO:src.workers.job_worker:Job parameters type: <class 'str'>, value: {"filename": "manifest.csv", "target_ref": "main", "commit_message": "Testing job API with manifest data", "temp_file_path": "/tmp/import_35_manifest.csv"}
INFO:src.workers.import_executor:Import job e0e53645-f5d6-45e8-acd0-7a793b387201 - parameters type: <class 'str'>, value: {"filename": "manifest.csv", "target_ref": "main", "commit_message": "Testing job API with manifest data", "temp_file_path": "/tmp/import_35_manifest.csv"}
INFO:src.workers.job_worker:Job e0e53645-f5d6-45e8-acd0-7a793b387201 completed successfully
INFO:     127.0.0.1:38614 - "GET /api/jobs HTTP/1.1" 200 OK
INFO:     127.0.0.1:59844 - "GET /api/jobs?status=completed HTTP/1.1" 200 OK
INFO:     127.0.0.1:59302 - "GET /api/jobs/2bb69f51-f10d-4e9d-a749-4762698c6318 HTTP/1.1" 401 Unauthorized
INFO:     127.0.0.1:54020 - "POST /api/users/login HTTP/1.1" 422 Unprocessable Entity
INFO:     127.0.0.1:58260 - "POST /api/users/login HTTP/1.1" 200 OK
INFO:     127.0.0.1:50274 - "GET /api/jobs/2bb69f51-f10d-4e9d-a749-4762698c6318 HTTP/1.1" 200 OK
INFO:     127.0.0.1:48788 - "GET /api/jobs/e0e53645-f5d6-45e8-acd0-7a793b387201 HTTP/1.1" 200 OK
INFO:     127.0.0.1:47912 - "GET /api/jobs?user_soeid=bg54677&status=completed HTTP/1.1" 200 OK
INFO:     127.0.0.1:38896 - "GET /api/jobs?dataset_id=35&limit=5 HTTP/1.1" 200 OK
INFO:     127.0.0.1:59636 - "POST /api/datasets/35/refs/main/commits HTTP/1.1" 422 Unprocessable Entity
INFO:     127.0.0.1:52130 - "POST /api/datasets/35/refs/main/commits HTTP/1.1" 500 Internal Server Error
ERROR:    Exception in ASGI application
Traceback (most recent call last):
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/protocols/http/httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/middleware/errors.py", line 187, in __call__
    raise exc
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
  File "/home/saketh/.local/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
  File "/home/saketh/.local/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
  File "/home/saketh/Projects/dsa/src/api/versioning.py", line 46, in create_commit
    return await handler.handle(dataset_id, ref_name, request, current_user["id"])
  File "/home/saketh/Projects/dsa/src/features/versioning/create_commit.py", line 44, in handle
    raise PermissionError("User lacks write permission")
PermissionError: User lacks write permission
INFO:     127.0.0.1:53838 - "GET /api/datasets/35/refs/main/data HTTP/1.1" 500 Internal Server Error
ERROR:    Exception in ASGI application
Traceback (most recent call last):
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/protocols/http/httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/middleware/errors.py", line 187, in __call__
    raise exc
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
  File "/home/saketh/.local/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
  File "/home/saketh/.local/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
  File "/home/saketh/Projects/dsa/src/api/versioning.py", line 82, in get_data_at_ref
    handler = GetDataAtRefHandler(uow)
TypeError: GetDataAtRefHandler.__init__() missing 1 required positional argument: 'dataset_repo'
WARNING:  WatchFiles detected changes in 'src/api/versioning.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:src.workers.job_worker:Stopping job worker...
INFO:src.main:Database pool closed
INFO:     Application shutdown complete.
INFO:     Finished server process [48347]
INFO:     Started server process [49298]
INFO:     Waiting for application startup.
INFO:src.main:Starting DSA Platform...
INFO:src.main:Database pool initialized
INFO:src.main:Dependencies initialized
INFO:src.workers.job_worker:Registered executor for job type: import
INFO:src.main:Job worker started
INFO:src.workers.job_worker:Starting job worker...
INFO:     Application startup complete.
INFO:     127.0.0.1:42788 - "GET /api/datasets/35/refs/main/data HTTP/1.1" 500 Internal Server Error
ERROR:    Exception in ASGI application
Traceback (most recent call last):
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/protocols/http/httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/middleware/errors.py", line 187, in __call__
    raise exc
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
  File "/home/saketh/.local/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
  File "/home/saketh/.local/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
  File "/home/saketh/Projects/dsa/src/api/versioning.py", line 84, in get_data_at_ref
    return await handler.handle(dataset_id, ref_name, request, current_user["id"])
  File "/home/saketh/Projects/dsa/src/features/versioning/get_data_at_ref.py", line 39, in handle
    raise PermissionError("User lacks read permission")
PermissionError: User lacks read permission
INFO:     127.0.0.1:58000 - "GET /api/datasets/35/history HTTP/1.1" 500 Internal Server Error
ERROR:    Exception in ASGI application
Traceback (most recent call last):
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/protocols/http/httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/middleware/errors.py", line 187, in __call__
    raise exc
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
  File "/home/saketh/.local/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
  File "/home/saketh/.local/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
  File "/home/saketh/Projects/dsa/src/api/versioning.py", line 178, in get_commit_history
    return await handler.handle(dataset_id, offset, limit)
  File "/home/saketh/Projects/dsa/src/features/versioning/get_commit_history.py", line 39, in handle
    total = await self.uow.commits.count_commits_for_dataset(dataset_id)
  File "/home/saketh/Projects/dsa/src/core/infrastructure/postgres/versioning_repo.py", line 252, in count_commits_for_dataset
    result = await self._conn.fetchval(query, dataset_id)
  File "/home/saketh/.local/lib/python3.10/site-packages/asyncpg/connection.py", line 714, in fetchval
    data = await self._execute(query, args, 1, timeout)
  File "/home/saketh/.local/lib/python3.10/site-packages/asyncpg/connection.py", line 1864, in _execute
    result, _ = await self.__execute(
  File "/home/saketh/.local/lib/python3.10/site-packages/asyncpg/connection.py", line 1961, in __execute
    result, stmt = await self._do_execute(
  File "/home/saketh/.local/lib/python3.10/site-packages/asyncpg/connection.py", line 2012, in _do_execute
    stmt = await self._get_statement(
  File "/home/saketh/.local/lib/python3.10/site-packages/asyncpg/connection.py", line 432, in _get_statement
    statement = await self._protocol.prepare(
  File "asyncpg/protocol/protocol.pyx", line 165, in prepare
asyncpg.exceptions.UndefinedColumnError: column ch.parent_commit_id does not exist
HINT:  Perhaps you meant to reference the column "c.parent_commit_id".
INFO:     127.0.0.1:35722 - "GET /openapi.json HTTP/1.1" 200 OK
WARNING:  WatchFiles detected changes in 'src/core/infrastructure/postgres/versioning_repo.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:src.workers.job_worker:Stopping job worker...
INFO:src.main:Database pool closed
INFO:     Application shutdown complete.
INFO:     Finished server process [49298]
INFO:     Started server process [49485]
INFO:     Waiting for application startup.
INFO:src.main:Starting DSA Platform...
INFO:src.main:Database pool initialized
INFO:src.main:Dependencies initialized
INFO:src.workers.job_worker:Registered executor for job type: import
INFO:src.main:Job worker started
INFO:src.workers.job_worker:Starting job worker...
INFO:     Application startup complete.
INFO:     127.0.0.1:50916 - "GET /api/datasets/35/history HTTP/1.1" 200 OK
INFO:     127.0.0.1:51158 - "GET /api/datasets/35/commits/20250706011603_a932d539/schema HTTP/1.1" 500 Internal Server Error
ERROR:    Exception in ASGI application
Traceback (most recent call last):
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/protocols/http/httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/middleware/errors.py", line 187, in __call__
    raise exc
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
  File "/home/saketh/.local/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
  File "/home/saketh/.local/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
  File "/home/saketh/Projects/dsa/src/api/versioning.py", line 95, in get_commit_schema
    handler = GetCommitSchemaHandler(uow)
TypeError: GetCommitSchemaHandler.__init__() missing 1 required positional argument: 'dataset_repo'
INFO:     127.0.0.1:45076 - "GET /api/datasets/35/refs/main/tables HTTP/1.1" 403 Forbidden
INFO:     127.0.0.1:44672 - "GET /api/datasets/35/commits/20250706011603_a932d539/data HTTP/1.1" 200 OK
WARNING:  WatchFiles detected changes in 'src/features/versioning/create_commit.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:src.workers.job_worker:Stopping job worker...
INFO:src.main:Database pool closed
INFO:     Application shutdown complete.
INFO:     Finished server process [49485]
INFO:     Started server process [50421]
INFO:     Waiting for application startup.
INFO:src.main:Starting DSA Platform...
INFO:src.main:Database pool initialized
INFO:src.main:Dependencies initialized
INFO:src.workers.job_worker:Registered executor for job type: import
INFO:src.main:Job worker started
INFO:src.workers.job_worker:Starting job worker...
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'src/features/versioning/get_data_at_ref.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:src.workers.job_worker:Stopping job worker...
INFO:src.main:Database pool closed
INFO:     Application shutdown complete.
INFO:     Finished server process [50421]
INFO:     Started server process [50490]
INFO:     Waiting for application startup.
INFO:src.main:Starting DSA Platform...
INFO:src.main:Database pool initialized
INFO:src.main:Dependencies initialized
INFO:src.workers.job_worker:Registered executor for job type: import
INFO:src.main:Job worker started
INFO:src.workers.job_worker:Starting job worker...
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'src/features/versioning/get_commit_schema.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:src.workers.job_worker:Stopping job worker...
INFO:src.main:Database pool closed
INFO:     Application shutdown complete.
INFO:     Finished server process [50490]
INFO:     Started server process [50721]
INFO:     Waiting for application startup.
INFO:src.main:Starting DSA Platform...
INFO:src.main:Database pool initialized
INFO:src.main:Dependencies initialized
INFO:src.workers.job_worker:Registered executor for job type: import
INFO:src.main:Job worker started
INFO:src.workers.job_worker:Starting job worker...
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'src/features/versioning/get_table_data.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:src.workers.job_worker:Stopping job worker...
INFO:src.main:Database pool closed
INFO:     Application shutdown complete.
INFO:     Finished server process [50721]
INFO:     Started server process [50813]
INFO:     Waiting for application startup.
INFO:src.main:Starting DSA Platform...
INFO:src.main:Database pool initialized
INFO:src.main:Dependencies initialized
INFO:src.workers.job_worker:Registered executor for job type: import
INFO:src.main:Job worker started
INFO:src.workers.job_worker:Starting job worker...
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'src/api/versioning.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:src.workers.job_worker:Stopping job worker...
INFO:src.main:Database pool closed
INFO:     Application shutdown complete.
INFO:     Finished server process [50813]
INFO:     Started server process [50934]
INFO:     Waiting for application startup.
INFO:src.main:Starting DSA Platform...
INFO:src.main:Database pool initialized
INFO:src.main:Dependencies initialized
INFO:src.workers.job_worker:Registered executor for job type: import
INFO:src.main:Job worker started
INFO:src.workers.job_worker:Starting job worker...
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'src/api/versioning.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:src.workers.job_worker:Stopping job worker...
INFO:src.main:Database pool closed
INFO:     Application shutdown complete.
INFO:     Finished server process [50934]
INFO:     Started server process [51060]
INFO:     Waiting for application startup.
INFO:src.main:Starting DSA Platform...
INFO:src.main:Database pool initialized
INFO:src.main:Dependencies initialized
INFO:src.workers.job_worker:Registered executor for job type: import
INFO:src.main:Job worker started
INFO:src.workers.job_worker:Starting job worker...
INFO:     Application startup complete.
INFO:     127.0.0.1:36598 - "POST /api/datasets/35/refs/main/commits HTTP/1.1" 500 Internal Server Error
ERROR:    Exception in ASGI application
Traceback (most recent call last):
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/protocols/http/httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/middleware/errors.py", line 187, in __call__
    raise exc
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
  File "/home/saketh/.local/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
  File "/home/saketh/.local/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
  File "/home/saketh/Projects/dsa/src/api/versioning.py", line 46, in create_commit
    return await handler.handle(dataset_id, ref_name, request, current_user["id"])
  File "/home/saketh/Projects/dsa/src/features/versioning/create_commit.py", line 52, in handle
    await self._commit_repo.add_rows_if_not_exist(rows_to_store)
  File "/home/saketh/Projects/dsa/src/core/infrastructure/postgres/versioning_repo.py", line 22, in add_rows_if_not_exist
    await self._conn.copy_records_to_table(
  File "/home/saketh/.local/lib/python3.10/site-packages/asyncpg/connection.py", line 1110, in copy_records_to_table
    intro_ps = await self._prepare(intro_query, use_cache=True)
  File "/home/saketh/.local/lib/python3.10/site-packages/asyncpg/connection.py", line 653, in _prepare
    stmt = await self._get_statement(
  File "/home/saketh/.local/lib/python3.10/site-packages/asyncpg/connection.py", line 432, in _get_statement
    statement = await self._protocol.prepare(
  File "asyncpg/protocol/protocol.pyx", line 165, in prepare
asyncpg.exceptions.UndefinedTableError: relation "dsa_core.rows" does not exist
INFO:     127.0.0.1:37426 - "GET /api/datasets/35/refs/main/data HTTP/1.1" 200 OK
INFO:     127.0.0.1:53964 - "GET /api/datasets/35/commits/20250706011603_a932d539/schema HTTP/1.1" 500 Internal Server Error
ERROR:    Exception in ASGI application
Traceback (most recent call last):
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/protocols/http/httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/middleware/errors.py", line 187, in __call__
    raise exc
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
  File "/home/saketh/.local/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
  File "/home/saketh/.local/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
  File "/home/saketh/Projects/dsa/src/api/versioning.py", line 96, in get_commit_schema
    return await handler.handle(dataset_id, commit_id, current_user["id"])
  File "/home/saketh/Projects/dsa/src/features/versioning/get_commit_schema.py", line 40, in handle
    sheets = self._transform_schema(schema_data)
  File "/home/saketh/Projects/dsa/src/features/versioning/get_commit_schema.py", line 58, in _transform_schema
    for col_name, col_info in sheet_info.get('columns', {}).items()
AttributeError: 'list' object has no attribute 'items'
INFO:     127.0.0.1:52318 - "GET /api/datasets/35/refs/main/tables HTTP/1.1" 500 Internal Server Error
ERROR:    Exception in ASGI application
Traceback (most recent call last):
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/protocols/http/httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/middleware/errors.py", line 187, in __call__
    raise exc
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
  File "/home/saketh/.local/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
  File "/home/saketh/.local/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
  File "/home/saketh/Projects/dsa/src/api/versioning.py", line 109, in list_tables
    return await handler.handle(dataset_id, ref_name, current_user["id"])
  File "/home/saketh/Projects/dsa/src/features/versioning/get_table_data.py", line 109, in handle
    ref = await self._uow.commits.get_ref(dataset_id, ref_name)
  File "/home/saketh/Projects/dsa/src/core/infrastructure/postgres/versioning_repo.py", line 117, in get_ref
    row = await self._conn.fetchrow(query, dataset_id, ref_name)
  File "/home/saketh/.local/lib/python3.10/site-packages/asyncpg/connection.py", line 748, in fetchrow
    data = await self._execute(
  File "/home/saketh/.local/lib/python3.10/site-packages/asyncpg/connection.py", line 1864, in _execute
    result, _ = await self.__execute(
  File "/home/saketh/.local/lib/python3.10/site-packages/asyncpg/connection.py", line 1961, in __execute
    result, stmt = await self._do_execute(
  File "/home/saketh/.local/lib/python3.10/site-packages/asyncpg/connection.py", line 2012, in _do_execute
    stmt = await self._get_statement(
  File "/home/saketh/.local/lib/python3.10/site-packages/asyncpg/connection.py", line 432, in _get_statement
    statement = await self._protocol.prepare(
  File "asyncpg/protocol/protocol.pyx", line 165, in prepare
asyncpg.exceptions.UndefinedColumnError: column "created_at" does not exist
WARNING:  WatchFiles detected changes in 'src/core/infrastructure/postgres/versioning_repo.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:src.workers.job_worker:Stopping job worker...
INFO:src.main:Database pool closed
INFO:     Application shutdown complete.
INFO:     Finished server process [51060]
INFO:     Started server process [51409]
INFO:     Waiting for application startup.
INFO:src.main:Starting DSA Platform...
INFO:src.main:Database pool initialized
INFO:src.main:Dependencies initialized
INFO:src.workers.job_worker:Registered executor for job type: import
INFO:src.main:Job worker started
INFO:src.workers.job_worker:Starting job worker...
INFO:     Application startup complete.
INFO:     127.0.0.1:37902 - "GET /api/datasets/35/refs/main/tables HTTP/1.1" 200 OK
INFO:     127.0.0.1:38956 - "GET /api/datasets/35/refs/main/tables/manifest_2/data HTTP/1.1" 200 OK
INFO:     127.0.0.1:54392 - "GET /api/datasets/35/refs/main/tables/manifest/data HTTP/1.1" 200 OK
INFO:     127.0.0.1:57162 - "GET /api/datasets/35/refs/main/tables/manifest/schema HTTP/1.1" 200 OK
WARNING:  WatchFiles detected changes in 'src/core/infrastructure/postgres/versioning_repo.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:src.workers.job_worker:Stopping job worker...
INFO:src.main:Database pool closed
INFO:     Application shutdown complete.
INFO:     Finished server process [51409]
INFO:     Started server process [52259]
INFO:     Waiting for application startup.
INFO:src.main:Starting DSA Platform...
INFO:src.main:Database pool initialized
INFO:src.main:Dependencies initialized
INFO:src.workers.job_worker:Registered executor for job type: import
INFO:src.main:Job worker started
INFO:src.workers.job_worker:Starting job worker...
INFO:     Application startup complete.
INFO:     127.0.0.1:46154 - "GET /docs HTTP/1.1" 200 OK
INFO:     127.0.0.1:46154 - "GET /openapi.json HTTP/1.1" 200 OK
WARNING:  WatchFiles detected changes in 'src/features/versioning/get_commit_schema.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:src.workers.job_worker:Stopping job worker...
INFO:src.main:Database pool closed
INFO:     Application shutdown complete.
INFO:     Finished server process [52259]
INFO:     Started server process [52584]
INFO:     Waiting for application startup.
INFO:src.main:Starting DSA Platform...
INFO:src.main:Database pool initialized
INFO:src.main:Dependencies initialized
INFO:src.workers.job_worker:Registered executor for job type: import
INFO:src.main:Job worker started
INFO:src.workers.job_worker:Starting job worker...
INFO:     Application startup complete.
INFO:     127.0.0.1:43628 - "POST /api/datasets/35/refs/main/commits HTTP/1.1" 500 Internal Server Error
ERROR:    Exception in ASGI application
Traceback (most recent call last):
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/protocols/http/httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/middleware/errors.py", line 187, in __call__
    raise exc
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
  File "/home/saketh/.local/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
  File "/home/saketh/.local/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
  File "/home/saketh/Projects/dsa/src/api/versioning.py", line 46, in create_commit
    return await handler.handle(dataset_id, ref_name, request, current_user["id"])
  File "/home/saketh/Projects/dsa/src/features/versioning/create_commit.py", line 55, in handle
    new_commit_id = await self._commit_repo.create_commit_and_manifest(
  File "/home/saketh/Projects/dsa/src/core/infrastructure/postgres/versioning_repo.py", line 75, in create_commit_and_manifest
    await self._conn.copy_records_to_table(
  File "/home/saketh/.local/lib/python3.10/site-packages/asyncpg/connection.py", line 1110, in copy_records_to_table
    intro_ps = await self._prepare(intro_query, use_cache=True)
  File "/home/saketh/.local/lib/python3.10/site-packages/asyncpg/connection.py", line 653, in _prepare
    stmt = await self._get_statement(
  File "/home/saketh/.local/lib/python3.10/site-packages/asyncpg/connection.py", line 432, in _get_statement
    statement = await self._protocol.prepare(
  File "asyncpg/protocol/protocol.pyx", line 165, in prepare
asyncpg.exceptions.UndefinedTableError: relation "dsa_core.commit_rows" does not exist
WARNING:  WatchFiles detected changes in 'src/core/infrastructure/postgres/versioning_repo.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:src.workers.job_worker:Stopping job worker...
INFO:src.main:Database pool closed
INFO:     Application shutdown complete.
INFO:     Finished server process [52584]
INFO:     Started server process [52673]
INFO:     Waiting for application startup.
INFO:src.main:Starting DSA Platform...
INFO:src.main:Database pool initialized
INFO:src.main:Dependencies initialized
INFO:src.workers.job_worker:Registered executor for job type: import
INFO:src.main:Job worker started
INFO:src.workers.job_worker:Starting job worker...
INFO:     Application startup complete.
INFO:     127.0.0.1:51216 - "POST /api/datasets/35/refs/main/commits HTTP/1.1" 200 OK
INFO:     127.0.0.1:33424 - "GET /api/datasets/35/commits/20250706011603_a932d539/schema HTTP/1.1" 200 OK
INFO:     127.0.0.1:60994 - "GET /api/datasets/35/commits/7a05d41a72852ea2a783fa089ee3d9b907680fb8dbd5605d187361cff1566a1e/data HTTP/1.1" 401 Unauthorized
INFO:     127.0.0.1:48826 - "POST /api/users/login HTTP/1.1" 200 OK
INFO:     127.0.0.1:53452 - "GET /api/datasets/35/commits/7a05d41a72852ea2a783fa089ee3d9b907680fb8dbd5605d187361cff1566a1e/data HTTP/1.1" 200 OK
INFO:     127.0.0.1:50400 - "GET /api/datasets/35/commits/7a05d41a72852ea2a783fa089ee3d9b907680fb8dbd5605d187361cff1566a1e/schema HTTP/1.1" 500 Internal Server Error
ERROR:    Exception in ASGI application
Traceback (most recent call last):
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/protocols/http/httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/middleware/errors.py", line 187, in __call__
    raise exc
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
  File "/home/saketh/.local/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
  File "/home/saketh/.local/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
  File "/home/saketh/Projects/dsa/src/api/versioning.py", line 96, in get_commit_schema
    return await handler.handle(dataset_id, commit_id, current_user["id"])
  File "/home/saketh/Projects/dsa/src/features/versioning/get_commit_schema.py", line 37, in handle
    raise ValueError(f"Schema not found for commit {commit_id}")
ValueError: Schema not found for commit 7a05d41a72852ea2a783fa089ee3d9b907680fb8dbd5605d187361cff1566a1e
INFO:     127.0.0.1:57464 - "GET /api/datasets/35/history HTTP/1.1" 200 OK
INFO:     127.0.0.1:60486 - "GET /api/datasets/35/refs/main/tables HTTP/1.1" 401 Unauthorized
INFO:     127.0.0.1:49302 - "POST /api/users/login HTTP/1.1" 200 OK
INFO:     127.0.0.1:49302 - "GET /api/datasets/35/refs/main/tables HTTP/1.1" 200 OK
WARNING:  WatchFiles detected changes in 'src/features/base_handler.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:src.workers.job_worker:Stopping job worker...
INFO:src.main:Database pool closed
INFO:     Application shutdown complete.
INFO:     Finished server process [52673]
INFO:     Started server process [54246]
INFO:     Waiting for application startup.
INFO:src.main:Starting DSA Platform...
INFO:src.main:Database pool initialized
INFO:src.main:Dependencies initialized
INFO:src.workers.job_worker:Registered executor for job type: import
INFO:src.main:Job worker started
INFO:src.workers.job_worker:Starting job worker...
INFO:     Application startup complete.
INFO:     127.0.0.1:58908 - "GET /api/datasets/35/refs/main/tables/default/schema HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:54896 - "GET /api/datasets/35/refs/main/tables/default/data?offset=0&limit=100 HTTP/1.1" 200 OK
WARNING:  WatchFiles detected changes in 'src/features/versioning/create_commit.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:src.workers.job_worker:Stopping job worker...
INFO:src.main:Database pool closed
INFO:     Application shutdown complete.
INFO:     Finished server process [54246]
INFO:     Started server process [54404]
INFO:     Waiting for application startup.
INFO:src.main:Starting DSA Platform...
INFO:src.main:Database pool initialized
INFO:src.main:Dependencies initialized
INFO:src.workers.job_worker:Registered executor for job type: import
INFO:src.main:Job worker started
INFO:src.workers.job_worker:Starting job worker...
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'src/features/versioning/get_commit_history.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:src.workers.job_worker:Stopping job worker...
INFO:src.main:Database pool closed
INFO:     Application shutdown complete.
INFO:     Finished server process [54404]
INFO:     Started server process [54734]
INFO:     Waiting for application startup.
INFO:src.main:Starting DSA Platform...
INFO:src.main:Database pool initialized
INFO:src.main:Dependencies initialized
INFO:src.workers.job_worker:Registered executor for job type: import
INFO:src.main:Job worker started
INFO:src.workers.job_worker:Starting job worker...
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'src/features/versioning/get_data_at_ref.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:src.workers.job_worker:Stopping job worker...
INFO:src.main:Database pool closed
INFO:     Application shutdown complete.
INFO:     Finished server process [54734]
INFO:     Started server process [54815]
INFO:     Waiting for application startup.
INFO:src.main:Starting DSA Platform...
INFO:src.main:Database pool initialized
INFO:src.main:Dependencies initialized
INFO:src.workers.job_worker:Registered executor for job type: import
INFO:src.main:Job worker started
INFO:src.workers.job_worker:Starting job worker...
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'src/features/versioning/get_table_data.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:src.workers.job_worker:Stopping job worker...
INFO:src.main:Database pool closed
INFO:     Application shutdown complete.
INFO:     Finished server process [54815]
INFO:     Started server process [55087]
INFO:     Waiting for application startup.
INFO:src.main:Starting DSA Platform...
INFO:src.main:Database pool initialized
INFO:src.main:Dependencies initialized
INFO:src.workers.job_worker:Registered executor for job type: import
INFO:src.main:Job worker started
INFO:src.workers.job_worker:Starting job worker...
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'src/features/versioning/queue_import_job.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:src.workers.job_worker:Stopping job worker...
INFO:src.main:Database pool closed
INFO:     Application shutdown complete.
INFO:     Finished server process [55087]
INFO:     Started server process [55154]
INFO:     Waiting for application startup.
INFO:src.main:Starting DSA Platform...
INFO:src.main:Database pool initialized
INFO:src.main:Dependencies initialized
INFO:src.workers.job_worker:Registered executor for job type: import
INFO:src.main:Job worker started
INFO:src.workers.job_worker:Starting job worker...
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'src/features/versioning/get_commit_schema.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:src.workers.job_worker:Stopping job worker...
INFO:src.main:Database pool closed
INFO:     Application shutdown complete.
INFO:     Finished server process [55154]
INFO:     Started server process [55268]
INFO:     Waiting for application startup.
INFO:src.main:Starting DSA Platform...
INFO:src.main:Database pool initialized
INFO:src.main:Dependencies initialized
INFO:src.workers.job_worker:Registered executor for job type: import
INFO:src.main:Job worker started
INFO:src.workers.job_worker:Starting job worker...
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'src/features/versioning/checkout_commit.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:src.workers.job_worker:Stopping job worker...
INFO:src.main:Database pool closed
INFO:     Application shutdown complete.
INFO:     Finished server process [55268]
INFO:     Started server process [55378]
INFO:     Waiting for application startup.
INFO:src.main:Starting DSA Platform...
INFO:src.main:Database pool initialized
INFO:src.main:Dependencies initialized
INFO:src.workers.job_worker:Registered executor for job type: import
INFO:src.main:Job worker started
INFO:src.workers.job_worker:Starting job worker...
INFO:     Application startup complete.
INFO:     127.0.0.1:39764 - "GET /api/datasets/35/history?offset=0&limit=50 HTTP/1.1" 200 OK
WARNING:  WatchFiles detected changes in 'src/features/__init__.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:src.workers.job_worker:Stopping job worker...
INFO:src.main:Database pool closed
INFO:     Application shutdown complete.
INFO:     Finished server process [55378]
INFO:     Started server process [55456]
INFO:     Waiting for application startup.
INFO:src.main:Starting DSA Platform...
INFO:src.main:Database pool initialized
INFO:src.main:Dependencies initialized
INFO:src.workers.job_worker:Registered executor for job type: import
INFO:src.main:Job worker started
INFO:src.workers.job_worker:Starting job worker...
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'src/models/pydantic_models.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:src.workers.job_worker:Stopping job worker...
INFO:src.main:Database pool closed
INFO:     Application shutdown complete.
INFO:     Finished server process [55456]
INFO:     Started server process [55868]
INFO:     Waiting for application startup.
INFO:src.main:Starting DSA Platform...
INFO:src.main:Database pool initialized
INFO:src.main:Dependencies initialized
INFO:src.workers.job_worker:Registered executor for job type: import
INFO:src.main:Job worker started
INFO:src.workers.job_worker:Starting job worker...
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'src/features/versioning/get_commit_history.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:src.workers.job_worker:Stopping job worker...
INFO:src.main:Database pool closed
INFO:     Application shutdown complete.
INFO:     Finished server process [55868]
INFO:     Started server process [55932]
INFO:     Waiting for application startup.
INFO:src.main:Starting DSA Platform...
INFO:src.main:Database pool initialized
INFO:src.main:Dependencies initialized
INFO:src.workers.job_worker:Registered executor for job type: import
INFO:src.main:Job worker started
INFO:src.workers.job_worker:Starting job worker...
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'src/features/versioning/checkout_commit.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:src.workers.job_worker:Stopping job worker...
INFO:src.main:Database pool closed
INFO:     Application shutdown complete.
INFO:     Finished server process [55932]
INFO:     Started server process [56011]
INFO:     Waiting for application startup.
INFO:src.main:Starting DSA Platform...
INFO:src.main:Database pool initialized
INFO:src.main:Dependencies initialized
INFO:src.workers.job_worker:Registered executor for job type: import
INFO:src.main:Job worker started
INFO:src.workers.job_worker:Starting job worker...
INFO:     Application startup complete.
INFO:     127.0.0.1:51854 - "GET /redocs HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:51862 - "GET /favicon.ico HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:51854 - "GET /favicon.ico HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:40856 - "GET /redoc HTTP/1.1" 200 OK
INFO:     127.0.0.1:40856 - "GET /openapi.json HTTP/1.1" 200 OK
INFO:     127.0.0.1:50640 - "POST /api/auth/login HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:55876 - "POST /api/auth/login HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:55890 - "GET /openapi.json HTTP/1.1" 200 OK
INFO:     127.0.0.1:39950 - "POST /api/users/login HTTP/1.1" 422 Unprocessable Entity
INFO:     127.0.0.1:53058 - "GET /openapi.json HTTP/1.1" 200 OK
INFO:     127.0.0.1:47894 - "POST /api/users/login HTTP/1.1" 200 OK
INFO:     127.0.0.1:47710 - "GET /api/datasets HTTP/1.1" 307 Temporary Redirect
INFO:     127.0.0.1:39334 - "GET /api/datasets HTTP/1.1" 307 Temporary Redirect
INFO:     127.0.0.1:55478 - "POST /api/datasets HTTP/1.1" 307 Temporary Redirect
INFO:     127.0.0.1:57584 - "GET /api/ HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:51962 - "POST /api/datasets/1/refs/main/commits HTTP/1.1" 200 OK
INFO:     127.0.0.1:42148 - "GET /api/datasets/1/refs/main/data?offset=0&limit=10 HTTP/1.1" 200 OK
WARNING:src.features.base_handler:Validation error in GetCommitSchemaHandler: Schema not found for commit d6ada49d32ae4843f70d79973add853a2e18c36e9709bb80b7a3c1a99db466d1
INFO:     127.0.0.1:47578 - "GET /api/datasets/1/commits/d6ada49d32ae4843f70d79973add853a2e18c36e9709bb80b7a3c1a99db466d1/schema HTTP/1.1" 500 Internal Server Error
ERROR:    Exception in ASGI application
Traceback (most recent call last):
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/protocols/http/httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/home/saketh/.local/lib/python3.10/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/middleware/errors.py", line 187, in __call__
    raise exc
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/home/saketh/.local/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
  File "/home/saketh/.local/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
  File "/home/saketh/.local/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
  File "/home/saketh/Projects/dsa/src/api/versioning.py", line 96, in get_commit_schema
    return await handler.handle(dataset_id, commit_id, current_user["id"])
  File "/home/saketh/Projects/dsa/src/features/base_handler.py", line 31, in wrapper
    return await func(self, *args, **kwargs)
  File "/home/saketh/Projects/dsa/src/features/versioning/get_commit_schema.py", line 41, in handle
    raise ValueError(f"Schema not found for commit {commit_id}")
ValueError: Schema not found for commit d6ada49d32ae4843f70d79973add853a2e18c36e9709bb80b7a3c1a99db466d1
INFO:     127.0.0.1:44178 - "GET /api/datasets/1/refs/main/tables HTTP/1.1" 200 OK
INFO:     127.0.0.1:44190 - "GET /api/datasets/1/refs/main/tables/default/data?offset=0&limit=5 HTTP/1.1" 200 OK
ERROR:src.features.base_handler:Unexpected error in GetTableSchemaHandler: 404: Table 'default' not found in this dataset
Traceback (most recent call last):
  File "/home/saketh/Projects/dsa/src/features/base_handler.py", line 31, in wrapper
    return await func(self, *args, **kwargs)
  File "/home/saketh/Projects/dsa/src/features/versioning/get_table_data.py", line 180, in handle
    raise HTTPException(
fastapi.exceptions.HTTPException: 404: Table 'default' not found in this dataset
INFO:     127.0.0.1:56980 - "GET /api/datasets/1/refs/main/tables/default/schema HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:56992 - "GET /api/datasets/1/history?offset=0&limit=10 HTTP/1.1" 200 OK
INFO:     127.0.0.1:33422 - "GET /api/datasets/1/commits/d6ada49d32ae4843f70d79973add853a2e18c36e9709bb80b7a3c1a99db466d1/data?offset=0&limit=5 HTTP/1.1" 200 OK
INFO:     127.0.0.1:50834 - "POST /api/datasets/1/refs/main/import HTTP/1.1" 200 OK
INFO:src.workers.job_worker:Processing job 51954d15-fde8-423e-b1e5-35cf363f97ff of type import
INFO:src.workers.job_worker:Job parameters type: <class 'str'>, value: {"filename": "test_import.csv", "target_ref": "main", "commit_message": "Import test data", "temp_file_path": "/tmp/import_1_test_import.csv"}
INFO:src.workers.import_executor:Import job 51954d15-fde8-423e-b1e5-35cf363f97ff - parameters type: <class 'str'>, value: {"filename": "test_import.csv", "target_ref": "main", "commit_message": "Import test data", "temp_file_path": "/tmp/import_1_test_import.csv"}
INFO:src.workers.job_worker:Job 51954d15-fde8-423e-b1e5-35cf363f97ff completed successfully
WARNING:  WatchFiles detected changes in 'src/features/versioning/get_data_at_ref.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:src.workers.job_worker:Stopping job worker...
INFO:src.main:Database pool closed
INFO:     Application shutdown complete.
INFO:     Finished server process [56011]
INFO:     Started server process [58288]
INFO:     Waiting for application startup.
INFO:src.main:Starting DSA Platform...
INFO:src.main:Database pool initialized
INFO:src.main:Dependencies initialized
INFO:src.workers.job_worker:Registered executor for job type: import
INFO:src.main:Job worker started
INFO:src.workers.job_worker:Starting job worker...
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'src/api/versioning.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:src.workers.job_worker:Stopping job worker...
INFO:src.main:Database pool closed
INFO:     Application shutdown complete.
INFO:     Finished server process [58288]
INFO:     Started server process [58334]
INFO:     Waiting for application startup.
INFO:src.main:Starting DSA Platform...
INFO:src.main:Database pool initialized
INFO:src.main:Dependencies initialized
INFO:src.workers.job_worker:Registered executor for job type: import
INFO:src.main:Job worker started
INFO:src.workers.job_worker:Starting job worker...
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'src/api/versioning.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:src.workers.job_worker:Stopping job worker...
INFO:src.main:Database pool closed
INFO:     Application shutdown complete.
INFO:     Finished server process [58334]
INFO:     Started server process [58404]
INFO:     Waiting for application startup.
INFO:src.main:Starting DSA Platform...
INFO:src.main:Database pool initialized
INFO:src.main:Dependencies initialized
INFO:src.workers.job_worker:Registered executor for job type: import
INFO:src.main:Job worker started
INFO:src.workers.job_worker:Starting job worker...
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'src/models/pydantic_models.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:src.workers.job_worker:Stopping job worker...
INFO:src.main:Database pool closed
INFO:     Application shutdown complete.
INFO:     Finished server process [58404]
INFO:     Started server process [58580]
INFO:     Waiting for application startup.
INFO:src.main:Starting DSA Platform...
INFO:src.main:Database pool initialized
INFO:src.main:Dependencies initialized
INFO:src.workers.job_worker:Registered executor for job type: import
INFO:src.main:Job worker started
INFO:src.workers.job_worker:Starting job worker...
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'src/core/abstractions/repositories.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:src.workers.job_worker:Stopping job worker...
INFO:src.main:Database pool closed
INFO:     Application shutdown complete.
INFO:     Finished server process [58580]
INFO:     Started server process [58792]
INFO:     Waiting for application startup.
INFO:src.main:Starting DSA Platform...
INFO:src.main:Database pool initialized
INFO:src.main:Dependencies initialized
INFO:src.workers.job_worker:Registered executor for job type: import
INFO:src.main:Job worker started
INFO:src.workers.job_worker:Starting job worker...
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'src/core/infrastructure/postgres/versioning_repo.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:src.workers.job_worker:Stopping job worker...
INFO:src.main:Database pool closed
INFO:     Application shutdown complete.
INFO:     Finished server process [58792]
INFO:     Started server process [58881]
INFO:     Waiting for application startup.
INFO:src.main:Starting DSA Platform...
INFO:src.main:Database pool initialized
INFO:src.main:Dependencies initialized
INFO:src.workers.job_worker:Registered executor for job type: import
INFO:src.main:Job worker started
INFO:src.workers.job_worker:Starting job worker...
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'src/features/versioning/checkout_commit.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:src.workers.job_worker:Stopping job worker...
INFO:src.main:Database pool closed
INFO:     Application shutdown complete.
INFO:     Finished server process [58881]
INFO:     Started server process [58951]
INFO:     Waiting for application startup.
INFO:src.main:Starting DSA Platform...
INFO:src.main:Database pool initialized
INFO:src.main:Dependencies initialized
INFO:src.workers.job_worker:Registered executor for job type: import
INFO:src.main:Job worker started
INFO:src.workers.job_worker:Starting job worker...
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'src/features/versioning/get_data_at_ref.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:src.workers.job_worker:Stopping job worker...
INFO:src.main:Database pool closed
INFO:     Application shutdown complete.
INFO:     Finished server process [58951]
INFO:     Started server process [59013]
INFO:     Waiting for application startup.
INFO:src.main:Starting DSA Platform...
INFO:src.main:Database pool initialized
INFO:src.main:Dependencies initialized
INFO:src.workers.job_worker:Registered executor for job type: import
INFO:src.main:Job worker started
INFO:src.workers.job_worker:Starting job worker...
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'tests/unit/features/test_checkout_commit_handler.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:src.workers.job_worker:Stopping job worker...
INFO:src.main:Database pool closed
INFO:     Application shutdown complete.
INFO:     Finished server process [59013]
INFO:     Started server process [59312]
INFO:     Waiting for application startup.
INFO:src.main:Starting DSA Platform...
INFO:src.main:Database pool initialized
INFO:src.main:Dependencies initialized
INFO:src.workers.job_worker:Registered executor for job type: import
INFO:src.main:Job worker started
INFO:src.workers.job_worker:Starting job worker...
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'tests/unit/features/test_checkout_commit_handler.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:src.workers.job_worker:Stopping job worker...
INFO:src.main:Database pool closed
INFO:     Application shutdown complete.
INFO:     Finished server process [59312]
INFO:     Started server process [59481]
INFO:     Waiting for application startup.
INFO:src.main:Starting DSA Platform...
INFO:src.main:Database pool initialized
INFO:src.main:Dependencies initialized
INFO:src.workers.job_worker:Registered executor for job type: import
INFO:src.main:Job worker started
INFO:src.workers.job_worker:Starting job worker...
INFO:     Application startup complete.
